<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-system/Software-Construction/note8">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Note8-详解七大设计模式 | 潜龙勿用</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://deconx.cn/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://deconx.cn/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://deconx.cn/system/Software-Construction/note8"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Note8-详解七大设计模式 | 潜龙勿用"><meta data-rh="true" name="description" content="本文结构图："><meta data-rh="true" property="og:description" content="本文结构图："><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://deconx.cn/system/Software-Construction/note8"><link data-rh="true" rel="alternate" href="https://deconx.cn/system/Software-Construction/note8" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://deconx.cn/system/Software-Construction/note8" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WBXP35154X-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="潜龙勿用 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="潜龙勿用 Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="潜龙勿用" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.4eab7d99.css">
<link rel="preload" href="/assets/js/runtime~main.77a452bf.js" as="script">
<link rel="preload" href="/assets/js/main.b7d7721f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.ico" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.ico" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">潜龙勿用</b></a><a class="navbar__item navbar__link" href="/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/system">计算机基础</a><a class="navbar__item navbar__link" href="/code-daily">算法刷题</a><a class="navbar__item navbar__link" href="/ai">人工智能</a><a class="navbar__item navbar__link" href="/project">动手造轮子</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kcxain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">首页</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/system">计算机基础</a><button aria-label="打开/收起侧边栏菜单「计算机基础」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/system/CSAPP">CSAPP 实验解析</a><button aria-label="打开/收起侧边栏菜单「CSAPP 实验解析」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/system/Computer-Network">计算机网络</a><button aria-label="打开/收起侧边栏菜单「计算机网络」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/system/MIT6S081">MIT-6.s081 实验解析</a><button aria-label="打开/收起侧边栏菜单「MIT-6.s081 实验解析」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/system/Software-Construction">软件构造</a><button aria-label="打开/收起侧边栏菜单「软件构造」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/note1">Note1-不可变(immutable)设计原则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/note2">Note2-设计规约(specification)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/note3">Note3-抽象数据类型(ADT)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/note4">Note4-面向对象编程(OOP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/note5">Note5-Equality in ADT and OOP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/note6">Note6-面向复用(reuse)的软件构造技术</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/note7">Note7-面向可维护性的软件构造技术</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/system/Software-Construction/note8">Note8-详解七大设计模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/system/Software-Construction/convex-problem">二维凸包问题详解</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/code-daily">算法刷题</a><button aria-label="打开/收起侧边栏菜单「算法刷题」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/ai">人工智能</a><button aria-label="打开/收起侧边栏菜单「人工智能」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/project">动手造轮子</a><button aria-label="打开/收起侧边栏菜单「动手造轮子」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/system"><span itemprop="name">计算机基础</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/system/Software-Construction"><span itemprop="name">软件构造</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Note8-详解七大设计模式</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Note8-详解七大设计模式</h1><p>本文结构图：</p><p><img loading="lazy" src="/assets/images/v2-4f93a69a370d9f6548d905ae4baa9fa8_720w-20b31cd1646e456b245efd18e3469fe6.webp" width="720" height="412" class="img_ev3q"></p><p>除了类本身，设计模式更强调多个类/对象之间的关系和交互过程——比接口/类复用的粒度更大</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建型模式creational-patterns">创建型模式(Creational patterns)<a href="#创建型模式creational-patterns" class="hash-link" aria-label="创建型模式(Creational patterns)的直接链接" title="创建型模式(Creational patterns)的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="工厂方法模式factory-method-pattern">工厂方法模式(Factory Method pattern)<a href="#工厂方法模式factory-method-pattern" class="hash-link" aria-label="工厂方法模式(Factory Method pattern)的直接链接" title="工厂方法模式(Factory Method pattern)的直接链接">​</a></h3><p>工厂方法也被称作<strong>虚拟构造器</strong>(Virtual Constructor)</p><p>即定义一个用于创建对象的接口，让子类类决定实例化哪个类，也就是说，工厂方法允许类将实例化推迟到子类</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="什么时候用">什么时候用？<a href="#什么时候用" class="hash-link" aria-label="什么时候用？的直接链接" title="什么时候用？的直接链接">​</a></h4><ul><li>当使用者不确定要创建哪个具体类的具体实例，或者不想在代码中指明要具体创建的实例时，用工厂方法</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="举例">举例<a href="#举例" class="hash-link" aria-label="举例的直接链接" title="举例的直接链接">​</a></h4><p>设计一个<code>Trace</code>接口：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// turn on and off debugging</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setDebug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> debug </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// write out a debug message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// write out an error message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们可能要设计两种实现，比如将信息直接打印到屏幕，或者输出到文件：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Concrete product 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">FileTrace</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">PrintWriter</span><span class="token plain"> pw</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> debug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">FileTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">PrintWriter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FileWriter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;t.log&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setDebug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> debug </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">debug </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> debug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> debug </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DEBUG: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">flush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ERROR: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">flush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Concret product 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SystemTrace</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> debug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setDebug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> debug </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">debug </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> debug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> debug </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DEBUG: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ERROR: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> message </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>那么用户要怎么使用呢？</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//... some code ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Trace</span><span class="token plain"> log1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SystemTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;entering log&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Trace</span><span class="token plain"> log2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FileTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;... &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这样做，客户端在创建对象时就要指定具体实现类，也就是说客户端的代码与实现类紧密<strong>耦合</strong>，如果有了新的具体类添加时，客户端的代码很可能也要修改</p><p>那么利用<strong>工厂方法</strong>该怎么实现呢？</p><p>先设计一个用于创建对象的接口：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">TraceFactory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">otherOperation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后分别设计两个<strong>工厂类</strong>，并设计<strong>工厂方法</strong>返回对应的具体类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SystemTraceFactory</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">TraceFactory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//other operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SystemTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">FileTraceFactory</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">TraceFactory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FileTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>客户端使用<strong>工厂方法</strong>来创建实例，这样在有新的具体产品类加入时，可以增加新的工厂类或修改已有工厂类，不会影响到客户端代码，这样使用：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//... some code ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Trace</span><span class="token plain"> log1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SystemTraceFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;entering log&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Trace</span><span class="token plain"> log2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FileTraceFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当然也可以有另一种实现方式，根据类型决定创建哪个具体产品</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">TraceFactory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">otherOperation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Factory</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">TraceFactory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;file&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FileTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;system&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SystemTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>客户端代码：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Trace</span><span class="token plain"> log </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Factory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;system&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setDebug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>甚至可以直接用<strong>静态工厂方法</strong>实现：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SystemTraceFactory</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SystemTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">TraceFactory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">Trace</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;file&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FileTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;system&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SystemTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这样客户端直接用类名调用就可以得到相应的对象</p><p>相比于通过<strong>构造器</strong>(new)创建对象：</p><ul><li>静态工厂方法可具有指定的更有意义的名称</li><li>不必在每次调用的时候的都创建新的工厂对象</li><li>可以返回原返回类型的任意子类型</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="优点与不足分析">优点与不足分析<a href="#优点与不足分析" class="hash-link" aria-label="优点与不足分析的直接链接" title="优点与不足分析的直接链接">​</a></h4><p><strong>优点</strong></p><ul><li>不会在客户端代码中含有特定的<strong>实现类</strong></li><li>代码只处理接口，所以它可以与用户定义的实现类一起使用</li></ul><p>不足：</p><ul><li>每增加一种产品就需要增加一个新的工厂子类</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="结构型模式structural-patterns">结构型模式(Structural patterns)<a href="#结构型模式structural-patterns" class="hash-link" aria-label="结构型模式(Structural patterns)的直接链接" title="结构型模式(Structural patterns)的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="适配器模式adapter">适配器模式(Adapter)<a href="#适配器模式adapter" class="hash-link" aria-label="适配器模式(Adapter)的直接链接" title="适配器模式(Adapter)的直接链接">​</a></h3><p>适配器模式意图将某个类/接口转换为用户期望的其他形式，它可以</p><ul><li>解决类之间接口不兼容的问题</li><li>通过增加一个接口，将以存在的子类封装起来，用户只需面向接口编程，从而隐藏了具体子类</li></ul><p>说白了，就是将旧的组件包装(wrapper)一下，用于新系统，下图就很直观：</p><p><img loading="lazy" src="data:image/webp;base64,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" width="310" height="419" class="img_ev3q"></p><p>适配器可以用两种形式实现：<strong>继承</strong>(Inheritance)和<strong>委托</strong>(Delegation)</p><p><img loading="lazy" src="/assets/images/v2-7818c80ae7d38f7be02fdf93665b1351_720w-9ffb83f76c605844d1b234910f0c9a03.webp" width="720" height="300" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="举例-1">举例<a href="#举例-1" class="hash-link" aria-label="举例的直接链接" title="举例的直接链接">​</a></h4><p>比如有一个显示矩形图案的程序，<code>LegacyRectangle</code>中的<code>display()</code>方法接受左上角坐标(x, y)，宽(w)，高(h)四个参数来实现功能</p><p>但是客户端想要通过传递左上角和右下角的坐标来实现功能</p><p>这样就造成了接口与用户期望的不协调，这种不协调就可以通过一个<strong>适配器对象</strong>利用<strong>委托</strong>机制来解决：</p><p><img loading="lazy" src="/assets/images/v2-89a60071783bb1d2aa3c8a9ee23e95c6_720w-3007c4fd8433d406c875468c9f1485ff.webp" width="720" height="280" class="img_ev3q"></p><p>代码：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Adaptor类实现抽象接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Shape</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> y1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> y2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//具体实现方法的适配</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Rectangle</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Shape</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> y1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> y2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">LegacyRectangle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x2</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y2</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">y1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//原始的类</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">LegacyRectangle</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> y1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//对适配器编程，与LegacyRectangle隔离</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Client</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Shape</span><span class="token plain"> shape </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Rectangle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shape</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="装饰器模式decorator">装饰器模式(Decorator)<a href="#装饰器模式decorator" class="hash-link" aria-label="装饰器模式(Decorator)的直接链接" title="装饰器模式(Decorator)的直接链接">​</a></h3><p><strong>装饰模式</strong>允许通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为</p><p>假设要为对象增加不同侧面的特性，那么就可以通过装饰器模式来解决，为每一个特性构造子类，通过<strong>委托</strong>机制增加到对象上</p><p><img loading="lazy" src="/assets/images/v2-fcf9416316eff5f46ef6bdb16ddc58f1_720w-eebe7149070f98a7c76e2bf5ab0032e6.webp" width="720" height="538" class="img_ev3q"></p><ul><li><code>Component</code>接口定义装饰器执行的公共操作</li><li><code>ConcreteComponent</code><strong>起始对象</strong>，在其基础上增加功能，将通用的方法放到此对象中</li><li><code>Decorator</code>抽象类使所有装饰类的基类，里面包含的成员变量<code>component</code>指向了被装饰的对象</li><li><code>ConcreteDecorator</code>使添加了功能的类，每个类都代表一个可以添加的特性</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="举例-2">举例<a href="#举例-2" class="hash-link" aria-label="举例的直接链接" title="举例的直接链接">​</a></h4><p>比如，假设想要扩展<code>Stack</code>数据结构：</p><ul><li><code>UndoStack</code>：可以撤销之前<code>pop</code>或<code>push</code>操作的栈</li><li><code>SecureStack</code>：需要密码的栈</li><li><code>SynchronizedStack</code>：序列化并发访问的栈</li></ul><p>我们可以通过继承原始的父类来实现这些特性</p><p>但是如果需要这些特性的组合呢？比如：</p><ul><li><code>SecureUndoStack</code>：需要密码的栈，还允许撤消之前的操作</li><li><code>SynchronizedUndoStack</code>：序列化并发访问的栈，还允许撤消之前的操作</li></ul><p>那么这个时候来怎么办呢？如果简简单单地继续往下继承：</p><p><img loading="lazy" src="data:image/webp;base64,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1Q1sq31K4GOPPbaBbQGntKd5e8rntKWS9957r6ouXrwY3RY7SWUDAACIEDYAAIAI3agAqKZpqso3Auw8JzsbprIBAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAEDE3tgNAACY79KlS1V1fHw8dkN2TdM0YzdhdxweHlbV0dHR2A3ZUiobAABARDObzcZuAwAja29z+kZg2zgyB/fKK69U1RNPPDF2Q3aHo7SbygYAABChsgGAO3NsKUcm289R2k1lAwAAiBA2AACACGEDAACIEDYAAIAID/UDVuRhW7vHc77OtfbJYuXhYsA2UdkAAAAiTH0LrMhkf7BVTgpTu3RWus6w/Ryl3VQ2AACACGM2AIDz5/YhRqduKne8FG3GIJvrGDo1tXvnq30Um6wzGOfWh8oGAAAQIWwAAAARulEBAIxvYcewnZwD4KyOnmknL53tK6VH09ZS2QAAACJUNoCUczrMcfDhnpsxerP73Ixc6qWEwccNL3uQb36KzNEPjO208C54x+4bcFv9d8fCJftvZe6SC/+9C4fgr9mAjmYs1c5Tf1zt397/I+qwyVkKtpzKBgAAEKGyAQyvZ8/jid/sGZYPc8OWOsj1Jt9yZ6ttp0ZH9LzHf8rCml7HGIz+Jan+Wzm7WMcQiDWtVirpqFF0rHbuWTa3grpw+MfclSz7taWmcYrKBgAAEKGyAWzUsre7zi6w8lY6VrXU8su28GT5nj2VB+lN3vOG+sp9qTdzq361j6Lne/svv+y9yYV7s+MW6Wr96VdjOMe26ThyVi509N/ihq12tVntoO1zEe7z9m5OqDtR2QAAACKEDQAAIEI3KiCrT2W5YxDewgkWez7vqXtVHd1alhrT2d2qZRu8TgM6Flh2CObCMaYdqx1Q/5kGlhrL23189hwY2rGShQftqZUsO9Z8tQHo+ntsv5U7Lg7YtzBqtWl/B5l9eDPTNpgH5YTKBgAAEKGyAQyv5zDH0W/5jN6ADev54W/V7c+tNfhBvs7d1v7v3aoTkFMG3zsLD4ntqXENOEPD4HrulzWHoe8wlQ0AACBCZQPIGmXKVG637M1LRY9lDXKQz717Gv3A+w/+2U5nx3rNXWAz21r4rrlvPNXC1f5Fy25l7vp7jqZb07L/wKU+ilNnze1DJua+tLCF1bum0bESIzdKZQMAAAhR2QCGN9TdoBVWspTt6a8cMsg/UDVjrq0a/LDyvfYdsNqH33MqufS2RtlKqD2JBmxy56623Y4TavTLwvZQ2QAAACKEDQAAIEI3KmB4mxy42d/mu2mdWvnoH0jHyNEBB252vHcLx/Ku3LalPrGOoavLNrv/UNcO/R9qCbAmlQ0AACCicScDWE3obujOD9qGkPM+le1cqi5sP0dpN5UNAAAgwpgNYHwLn0IFAJxHKhsAAECEygYwPnUMANhJKhsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABEmPoWANhSFy5cqHnP/YTtsb+/P3YTtprKBgAAECFsAAAAEbpRAQBb6j//+U9VzWazsRsCd6SbXzeVDQAAIEJlA1jR3XffXe7owNZoT0mAraKyAQAARDT6QQKraWsariGwJU7KjLt0VrrOsP0cpd1UNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACI2Bu7AQAA8919991V1TTN2A2BO7rnnnvGbsJWU9kAAAAihA0AACCimc1mY7cBOJfajg2uIbAlTvoa7dJZ6TrD9nOUdlPZAAAAIoQNAAAgQtgAAAAiTH0LrGh/f79MSQlboz0lAbaKygYAABBhNipgRebfgK1iNioYhaO0m8oGAAAQIWwAAAARwgYAABAhbAAAABHCBgAAECFsAAAAEcIGAAAQIWwAAAARwgYAABAhbAAAABHCBgAAECFsAAAAEcIGAAAQIWwAAAARwgYAABAhbAAAABHCBgAAECFsAAAAEcIGAAAQIWwAAAARwgYAABAhbAAAABHCBgAAECFsAAAAEcIGAAAQIWwAAAARwgYAABAhbAAAABHCBgAAELE3dgMAAOY7ODioqqZpxm4I3FF7lHInKhsAAEBEM5vNxm4DcC619xpdQ2BLnNz+d1Yy1w9+8IOqeu2116rqvffeq6r9/f2R28QEqGwAAAARKhvAilQ2YKuobDDX8fFx+8OTTz5ZVd/61req6ubNm1V148aNERvGRKhsAAAAEcIGAAAQYepbAICddf369faHF154oaoODw+r6tq1a3VbD6v2j5CgsgEAAESobAAr8rAt2CqeLMYpr7zySlU98MAD7a+XL18+eenZZ5+tjybDraq33npr461jKlQ2AACACFPfAgDslFu3blXVlStX6raqxcWLF08t9vjjj7c/PProo1X12GOPba6JTIbKBgAAEKGyAQCwU9rBGPfdd19Vff/737/TYh988EH7Q1sDeffdd6tqf39/E01kMlQ2AACACGEDAACI0I0KAGBHtM/pe/LJJ6vq6Oio57uef/75qrp582ZV3bhxI9Y6pkhlAwAAiFDZAADYEZcuXaqql19+uaoODw9Xfu8Kb4e5VDYAAICIvbEbAADAWl588cX2h8uXL9eqRYkXXnihqq5fv97++s477wzUOiZNZQMAAIgQNgAAgAgDxAEAzqv2KeCPPPJI++sbb7xRVRcvXlx5he20uVV19erVqnriiSfWbSLTprIBAABEqGwAAJxX7XjuBx98sP31O9/5zporbEslVXXt2rX6aJj4wcHBmqtlslQ2AACACJUNAIDz5/j4uD4aYnF0dDT4+p9//vmqunnzZlXduHFj8PUzESobAABAhMoGAMD5085A9eabb25gW//85z9rvUmumCyVDQAAIELYAAAAInSjAgCYiqZpqsp//9gYlQ0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACBC2AAAACKEDQAAIKKZzWZjtwEAWODSpUtVdXx8PHZDAOrw8LCqjo6OFi6psgEAAESobADAOdA0TVX51mZNt27dqqqDg4OxG8L51v+KpLIBAABEqGwAwDmgsgFsD5UNAABgZMIGAAAQIWwAAAARwgYAABAhbAAAABHCBgAAECFsAAAAEcIGAAAQsTd2AwCAAbTP2Jpryx8FeHvLt7yptxu92R0NWO2lwZ06Jtff3Pk9yAe37Ecx4lNBVTYAAIAIlQ0AON867h+3L50sMLW7v1E+zE1ykLcWfg71v0WMjgLIxqhsAAAAEcIGAAAQoRsVAOysjqGiHcss2/Wio+PK3FUNsvzCAbL9R9Au/PcubMDJAkutasAWDmK1z6Hne/svv2w/qNVa1f+g6thlq700d/3rfyB9jpm5w8TPLtn/I+0z7lxlAwAAiFDZAICdsnBu01N3UjuGk57949x7on1ul96+qo67of3Xv/Bdq61wtQbc6e3VeYN57rtODXde2LacnoOwl72j33PvnH2150pW20pHnWrwSWMHPFw73ttxRp9672o7+nZf/OIX2x/efvvts6+qbAAAABEqGwBwvnXcKB38qWprGr0Bm9T/w9+G+Um33DoH+cof7+YP12WHzaxzsvcfaNS/PXOpbAAAABEqGwCwU/pPg0PIwhEFpyh6LGupg/wc1dPWmYlrzQnBcg8BVNkAAAAihA0AACBCNyoAON9WGwU+d37Ppdawgs1sZUTr/wP1m5prwKkOVhu4P8rherYB2zblQ9ueq1evtr+a+hYAANicZvRIBAAstPDJYh13xLu/68++cdmHjnVsZdmH06U3nW7AUoOVV2thn+WXXf/c5Xs+ua9nC7tXuLBtq71rkOWXXfPZd/UpR2zyn9b/6Oq5o7uvMCobAABAhMoGAJwDCysba6655X8FQB/9r0gqGwAAQISwAQAARJj6FgCmZYUhngCrUdkAAAAiVDYAYFoUMYCNUdkAAAAihA0AACBC2AAAACKEDQAAIELYAAAAIoQNAAAgQtgAAAAihA0AACDCQ/0A4By46667qqppmrEbAlB7e31DhMoGAAAQ0cxms7HbAAAs0NY0fGsD26D/FUllAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiDog9JkAAAGdSURBVBA2AACACGEDAACIEDYAAIAIYQMAAIgQNgAAgAhhAwAAiBA2AACACGEDAACIEDYAAIAIYQMAAIjYG7sBAMBid911V1U1TTN2QwDqwoULPZdU2QAAACKEDQAAIKKZzWZjtwEAWKDtQOVbG9gG/a9IKhsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAxN7YDQAAFjs4OKiqpmnGbgjA/12R+lDZAAAAIprZbDZ2GwAAgB2ksgEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAECEsAEAAEQIGwAAQISwAQAARAgbAABAhLABAABECBsAAEDE/wcKnd5FwLkKHwAAAABJRU5ErkJggg==" width="1060" height="763" class="img_ev3q"></p><p>这样不仅会使继承树变得很深，还会在子类中多次实现相同的功能，有大量的<strong>代码重复</strong></p><p>这时就能用装饰器模式解决问题：</p><p><img loading="lazy" src="/assets/images/v2-6b94bd6c27b38a02ab49f83dc7cb5f8e_720w-84e432a09448750b249cc61dc39f832b.webp" width="720" height="698" class="img_ev3q"></p><p>首先实现接口，完成最基础的<code>Stack</code>功能：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Stack</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Item</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Item</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ArrayStack</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Stack</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//rep</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">ArrayStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Item</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Item</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后设计<code>Decorator</code>基类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">StackDecorator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Stack</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Stack</span><span class="token plain"> stack</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">StackDecorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Stack</span><span class="token plain"> stack</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stack </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> stack</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Item</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Item</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> stack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>具体功能的实现类就通过<strong>委托</strong>基类实现：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">UndoStack</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">StackDecorator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">UndoLog</span><span class="token plain"> log </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UndoLog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">UndoStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Stack</span><span class="token plain"> stack</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 委托</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stack</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Item</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 新特性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">UndoLog</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PUSH</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">undo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//implement decorator behaviors on stack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果客户端只需要最基础的功能：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Stack</span><span class="token plain"> s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果需要某个特性，比如撤销功能：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Stack</span><span class="token plain"> t </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UndoStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果既需要撤销，又需要密码功能<code>SecureUndoStack</code>，就可以这样实现：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Stack</span><span class="token plain"> t </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SecureStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SychronizedStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UndoStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>客户端需要的多个特性通过一层一层的装饰来实现，就像一层一层的穿衣服</p><p>有同学可能对这个代码执行过程还存有疑问，我们再举一个更直观的例子：</p><p>我们设计一个冰淇凌，冰淇淋的顶部可以有多种水果：</p><p>分别设计顶层接口，基础实现，和装饰器基类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">IceCream</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//顶层接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">AddTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PlainIceCream</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">IceCream</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//基础实现，无填加的冰激凌</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">AddTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">&quot;</span><span class="token class-name">Plain</span><span class="token plain"> </span><span class="token class-name">IceCream</span><span class="token plain"> ready </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> some</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                toppings</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/*装饰器基类*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ToppingDecorator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">IceCream</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">IceCream</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">ToppingDecorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">IceCream</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">input </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">AddTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//留给具体装饰器实现</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后再添加不同的特性：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CandyTopping</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">ToppingDecorator</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">CandyTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">IceCream</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">AddTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name namespace" style="opacity:0.7">input</span><span class="token class-name namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token class-name">AddTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//decorate others first</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Candy Topping added！&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">NutsTopping</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">ToppingDecorator</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//similar to CandyTopping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PeanutTopping</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">ToppingDecorator</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//similar to CandyTopping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当我们的客户端需要一个添加<code>Candy</code>,<code>Nuts</code>,<code>Peanut</code>的冰淇淋时就可以这样调用：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">IceCream</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">PlainIceCream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">IceCream</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CandyTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">IceCream</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">PeanutTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">IceCream</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">NutsTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name namespace" style="opacity:0.7">d</span><span class="token class-name namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token class-name">AddTopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当调用<code>d.AddTopping()</code>时：</p><ul><li>由于<code>d</code>是子类<code>NutsTopping</code>的对象，所以先会调用<code>NutsTopping</code>中的<code>AddTopping()</code>方法，而该方法先调用<code>input.AddTopping()</code>也就是上一层的<code>AddTopping()</code>方法</li><li>所以，<code>d</code>会先从基础实现开始依次实现特定功能</li></ul><p>这时一个类似于<strong>递归</strong>的过程，最后输出如下：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Plain</span><span class="token plain"> </span><span class="token class-name">IceCream</span><span class="token plain"> ready </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> some toppings</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Candy</span><span class="token plain"> </span><span class="token class-name">Topping</span><span class="token plain"> added！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Peanut</span><span class="token plain"> </span><span class="token class-name">Topping</span><span class="token plain"> added！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Nuts</span><span class="token plain"> </span><span class="token class-name">Topping</span><span class="token plain"> added！</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="decorator-vs-inheritance">Decorator vs. inheritance<a href="#decorator-vs-inheritance" class="hash-link" aria-label="Decorator vs. inheritance的直接链接" title="Decorator vs. inheritance的直接链接">​</a></h4><p>装饰器：</p><ul><li>在<strong>运行时</strong>将特性组合起来</li><li>由多个对象协作组成</li><li>可以混合多种特性</li></ul><p>继承：</p><ul><li>在<strong>编译时</strong>将特性组合</li><li>继承产生一个<strong>单一</strong>、<strong>形式明确</strong>的对象</li><li><strong>多继承</strong>是很难实现的</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="javautilcollections中的装饰器"><code>java.util.Collections</code>中的装饰器<a href="#javautilcollections中的装饰器" class="hash-link" aria-label="javautilcollections中的装饰器的直接链接" title="javautilcollections中的装饰器的直接链接">​</a></h4><p><code>Java</code>中的一些可变聚合类型(List, Set, Map)，可以利用<code>Collections</code>类中的<strong>装饰器</strong>添加某些特性</p><p>比如变成不可变类型</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Trace</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> ts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">LinkedList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Trace</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> ts2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Trace</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token class-name">Collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unmodifiableCollection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="行为类模式behavioral-patterns">行为类模式(Behavioral patterns)<a href="#行为类模式behavioral-patterns" class="hash-link" aria-label="行为类模式(Behavioral patterns)的直接链接" title="行为类模式(Behavioral patterns)的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="策略模式strategy">策略模式(Strategy)<a href="#策略模式strategy" class="hash-link" aria-label="策略模式(Strategy)的直接链接" title="策略模式(Strategy)的直接链接">​</a></h3><p>策略模式要解决这样的问题：定义一系列算法， 并将每种算法分别放入独立的类中， 以使算法的对象能够相互替换</p><p><img loading="lazy" src="/assets/images/v2-6ba99b81026c80d1f913f9b291da63e8_720w-8458c05fcb3673577615276ea422421e.webp" width="308" height="307" class="img_ev3q"></p><p>比如，排序有很多算法（冒泡，归并，快排）</p><p>我们可以为不同的实现算法构造抽象接口，利用委托，在运行时动态传入客户端倾向的算法类实例</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="优点">优点<a href="#优点" class="hash-link" aria-label="优点的直接链接" title="优点的直接链接">​</a></h4><ul><li>可以轻松扩展新的算法实现</li><li>将算法从客户端代码中分离出来</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="举例-3">举例<a href="#举例-3" class="hash-link" aria-label="举例的直接链接" title="举例的直接链接">​</a></h4><p>在电子商务应用中需要实现各种支付方法， 客户选中希望购买的商品后需要选择一种支付方式： Paypal 或者信用卡</p><p>先设计支付策略接口：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">PaymentStrategy</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> amount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>实现信用卡支付策略：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CreditCardStrategy</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">PaymentStrategy</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> cardNumber</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> cvv</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> dateOfExpiry</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">CreditCardStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> nm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> ccNum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><span class="token class-name">String</span><span class="token plain"> cvv</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> expiryDate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nm</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cardNumber</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ccNum</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cvv</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">cvv</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dateOfExpiry</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">expiryDate</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> amount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">amount </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot; paid with credit card&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>实现 Paypal 支付策略：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PaypalStrategy</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">PaymentStrategy</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> emailId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">PaypalStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> pwd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">emailId</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">email</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">password</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pwd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> amount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">amount </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; paid using Paypal.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后利用委托调用相应算法：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ShoppingCart</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">PaymentStrategy</span><span class="token plain"> paymentMethod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> amount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">calculateTotal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        paymentMethod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>客户端代码：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ShoppingCart</span><span class="token plain"> cart </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ShoppingCart</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Item</span><span class="token plain"> item1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;1234&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Item</span><span class="token plain"> item2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;5678&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cart</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cart</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//pay by paypal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cart</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">PaypalStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;myemail@exp.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mypwd&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//pay by credit card</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cart</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CreditCardStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Alice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1234&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;786&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;12/18&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="模板模式template-method">模板模式(Template Method)<a href="#模板模式template-method" class="hash-link" aria-label="模板模式(Template Method)的直接链接" title="模板模式(Template Method)的直接链接">​</a></h3><p><strong>模板方法模式</strong>在超类中定义了一个算法的框架， 允许子类在不修改结构的情况下重写算法的特定步骤</p><p>就是做事情的步骤一样，但是具体方法不同：</p><p><img loading="lazy" src="/assets/images/v2-3a67e1f4c8ca2b541a65c5a951dcc51e_720w-5d8c9ee94b1888bce4d6c1bfeec744ff.webp" width="237" height="273" class="img_ev3q"></p><p>比如从不同类型的文件中进行读操作，对于不同文件，这个操作的步骤相同，但是具体实现不同</p><p><img loading="lazy" src="/assets/images/v2-9c54c5f75d3960e2ea006d6ef08e0529_720w-217490294e5e629191838d7df9069bab.webp" width="720" height="541" class="img_ev3q"></p><p>这时，可以把共性的步骤放在抽象类内公共实现，差异化的步骤在各个子类中实现。模板方法定义了一个算法的步骤，并允许子类为一个或多个步骤提供实现</p><p>模板模式通过继承和重写来实现，这种模式广泛用于各种<strong>框架</strong>(frameworks)中</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="举例-4">举例<a href="#举例-4" class="hash-link" aria-label="举例的直接链接" title="举例的直接链接">​</a></h4><p>我们需要实现两种汽车生产的过程，显然步骤都相同，但是具体实现会有差异</p><p><img loading="lazy" src="/assets/images/v2-c7ec0ab452b4dc4397f74fc0c34fa875_720w-36a535d008277f1736c30dcf0fe8841b.webp" width="720" height="639" class="img_ev3q"></p><p>先实现一个抽象类，<code>BuildCar</code>中给出了生产车辆的步骤：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CarBuilder</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">BuildSkeleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">InstallEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">InstallDoor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Template Method that specifies the general logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">BuildCar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//通用逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">BuildSkeleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">InstallEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">InstallDoor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后再为车进行具体实现：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PorcheBuilder</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">CarBuilder</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">BuildSkeleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Building Porche Skeleton&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">InstallEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Installing Porche Engine&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">InstallDoor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Installing Porche Door&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">BeetleBuilder</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">CarBuilder</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">BuildSkeleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Building Beetle Skeleton&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">InstallEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Installing Beetle Engine&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">InstallDoor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Installing Beetle Door&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>再比如白盒框架，框架已经将某个功能的步骤再抽象类中写好了，我们使用该框架时只需要重写对应的方法即可</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="迭代器模式iterator">迭代器模式(Iterator)<a href="#迭代器模式iterator" class="hash-link" aria-label="迭代器模式(Iterator)的直接链接" title="迭代器模式(Iterator)的直接链接">​</a></h3><p>解决这样的问题：在不暴露集合底层表现形式 （列表、 栈和树等） 的情况下遍历集合中所有的元素</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="结构">结构<a href="#结构" class="hash-link" aria-label="结构的直接链接" title="结构的直接链接">​</a></h4><p>该模式的结构：</p><p><img loading="lazy" src="data:image/webp;base64,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" width="480" height="430" class="img_ev3q"></p><ul><li><code>Iterator</code>接口：声明了遍历集合所需的操作： 获取下一个元素、 获取当前位置和重新开始迭代等</li><li><code>Concrete Iterators</code>实现类：实现遍历集合的一种特定算法。 迭代器对象必须跟踪自身遍历的进度。 这使得多个迭代器可以相互独立地遍历同一集合</li><li><code>Collection</code>接口：声明一个或多个方法来获取与集合兼容的迭代器。 注意， 返回方法的类型必须被声明为迭代器接口， 因此具体集合可以返回各种不同种类的迭代器</li><li><code>Concrete Collections</code>实现类：在客户端请求迭代器时返回一个特定的具体迭代器类实体</li></ul><p>简单来说，就是让自己的集合类实现<code>Iterable</code>接口，并实现自己的独特<code>Iterator</code>迭代器(hasNext, next, remove)，允许客户端利用这个迭代器进行显式或隐式的迭代遍历：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">E</span><span class="token plain"> e </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> collection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Iterator</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">E</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> iter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">iterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">hasNext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="举例-5">举例<a href="#举例-5" class="hash-link" aria-label="举例的直接链接" title="举例的直接链接">​</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Pair</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">E</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Iterable</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">E</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">E</span><span class="token plain"> first</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> second</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Pair</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">E</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">E</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> first </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> second </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Iterator</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">E</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">iterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">PairIterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PairIterator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Iterator</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">E</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> seenFirst </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seenSecond </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hasNext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">seenSecond</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">E</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">seenFirst</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> seenFirst </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> first</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">seenSecond</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> seenSecond </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> second</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">NoSuchElementException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UnsupportedOperationException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="访问者模式visitor">访问者模式(Visitor)<a href="#访问者模式visitor" class="hash-link" aria-label="访问者模式(Visitor)的直接链接" title="访问者模式(Visitor)的直接链接">​</a></h3><p>它能将算法与其所作用的对象隔离开来</p><p>这种模式可以为 ADT 预留一个将来可扩展功能的接入点，外部实现的功能代码可以在不改变 ADT 本身的情况下在需要时通过委托接入 ADT</p><p><img loading="lazy" src="/assets/images/v2-225e5ff2e899e1c4ffec52ffa7606588_720w-df1b053805379e4bff94fcd04b7a7a1b.webp" width="720" height="442" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="举例-6">举例<a href="#举例-6" class="hash-link" aria-label="举例的直接链接" title="举例的直接链接">​</a></h4><p>想想这样一个问题，需要查看超市货架的物品</p><p>先设计数据操作的抽象接口：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* Abstract element interface (visitable) */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">ItemElement</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ShoppingCartVisitor</span><span class="token plain"> visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后为每种商品具体实现：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* Concrete element */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Book</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">ItemElement</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> price</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ShoppingCartVisitor</span><span class="token plain"> visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 处理数据的功能委托给visitor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        visitor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Fruit</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">ItemElement</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> weight</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ShoppingCartVisitor</span><span class="token plain"> visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        visitor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>设计访问者接口：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* Abstract visitor interface */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">ShoppingCartVisitor</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Book</span><span class="token plain"> book</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Fruit</span><span class="token plain"> fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>客户端实现一种<code>visitor</code>：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ShoppingCartVisitorImpl</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">ShoppingCartVisitor</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Book</span><span class="token plain"> book</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> cost</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">book</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPrice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cost </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> book</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPrice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cost </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> book</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPrice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Book ISBN::&quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">book</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getIsbnNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; cost =&quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">cost</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> cost</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Fruit</span><span class="token plain"> fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> cost </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fruit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPricePerKg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">fruit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getWeight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fruit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; cost = &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">cost</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> cost</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>客户端均通过<code>visitor</code>的实现类来访问数据，比如设计计算价格和的方法：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ShoppingCartClient</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">ItemElement</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> items </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ItemElement</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Book</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1234&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Book</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5678&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Fruit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Banana&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Fruit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Apple&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> total </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">calculatePrice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Total Cost = &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">total</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">calculatePrice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ItemElement</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> items</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">ShoppingCartVisitor</span><span class="token plain"> visitor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ShoppingCartVisitorImpl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> sum</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ItemElement</span><span class="token plain"> item </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> items</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sum </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> sum</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这样，如果后续想要改变算法，只要更换<code>visitor</code>即可</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="visitor-vs-iterator">Visitor vs. Iterator<a href="#visitor-vs-iterator" class="hash-link" aria-label="Visitor vs. Iterator的直接链接" title="Visitor vs. Iterator的直接链接">​</a></h4><p>这两者功能很相似，我们来做个对比：</p><ul><li>迭代器：以遍历的方式访问集合数据而无需暴露其内部表示，将遍历这项功能<strong>委托</strong>给到外部的<code>iterator</code>对象</li><li>访问者：在特定 ADT 上执行某种特定操作，但该操作不在 ADT 内部实现，而是委托给独立的<code>visitor</code>对象，客户端可灵活扩展/改<code>visitor</code>的操作算法，而不影响 ADT</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="strategy-vs-visitor">Strategy vs. Visitor<a href="#strategy-vs-visitor" class="hash-link" aria-label="Strategy vs. Visitor的直接链接" title="Strategy vs. Visitor的直接链接">​</a></h4><p>相同点：</p><p>两者都是通过<strong>委托</strong>建立两个对象的动态联系</p><p>区别：</p><ul><li>Visitor 强调的是外部定义某种对 ADT 的操作，该操作与 ADT 自身关系不大（只是访问ADT），故ADT内部只需要开放<code>accept(visitor)</code>即可，客户端通过它设定<code>visitor</code>操作并在外部调用</li><li>Strategy则强调是对 ADT 内部某些要实现的功能的相应算法的灵活替换。这些算法是 ADT 功能的重要组成部分，只不过是<strong>委托</strong>到外部<code>strategy</code>类而已</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="设计模式的共性">设计模式的共性<a href="#设计模式的共性" class="hash-link" aria-label="设计模式的共性的直接链接" title="设计模式的共性的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="共性样式继承">共性样式：继承<a href="#共性样式继承" class="hash-link" aria-label="共性样式：继承的直接链接" title="共性样式：继承的直接链接">​</a></h3><p>特点就是只使用<strong>继承</strong>，而不使用<strong>委托</strong></p><p><img loading="lazy" src="/assets/images/v2-6a5253cf2f3d92e29c78720dd29de1a8_720w-26a0b51105e3d71a9b5609dcd6c0db30.webp" width="958" height="529" class="img_ev3q"></p><p>比如，<strong>适配器模式</strong>(Adaptor)</p><p><img loading="lazy" src="/assets/images/v2-05bf6af500333a986145b6a212e5a775_720w-de8b58bb21a57c795b84214c4fd998f6.webp" width="720" height="536" class="img_ev3q"></p><p><strong>适用场合</strong>：已经有了一个类，但是其方法与目前客户端的需求不一致</p><p>根据 OCP 原则，不能修改这个类，所以扩展一个<code>adptor</code>和一个统一的接口</p><p><strong>模板模式</strong>(Template)</p><p><img loading="lazy" src="/assets/images/v2-83b88ff8508d3d41ce843bf9073e2011_720w-e6f5b8ecae9b0f21266bdd0248263a4c.webp" width="720" height="458" class="img_ev3q"></p><p><strong>适用场合</strong>：有共性的算法流程，但算法各步骤有不同的实现，典型的“将共性提升至超类型，将个性保留在子类型”</p><p>注意：如果某个步骤不需要有多种实现，直接在该抽象类里写出共性实现即可（需要时将方法设置为<code>final</code>，不允许<code>override</code>）</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="共性样式继承委托">共性样式：继承+委托<a href="#共性样式继承委托" class="hash-link" aria-label="共性样式：继承+委托的直接链接" title="共性样式：继承+委托的直接链接">​</a></h3><p>特点就是有两颗<strong>继承树</strong>，有两个层次的<strong>委托</strong></p><p><img loading="lazy" src="/assets/images/v2-40537a948a35f558265514eee911a394_720w-9d8e220392865dca84cdef1740a5d339.webp" width="720" height="264" class="img_ev3q"></p><p>比如，<strong>策略模式</strong>(Strategy)</p><p><img loading="lazy" src="/assets/images/v2-07be5f84fafe70ed0614891c764b9106_720w-8a623ecacc7f54d1997dea59b3c8e136.webp" width="720" height="449" class="img_ev3q"></p><p>根据 OCP 原则，想有多个算法的实现，在右侧树里扩展子类型即可，在左侧子类型里传入不同的类型实例</p><p><strong>迭代器模式</strong>(Iterator)</p><p><img loading="lazy" src="/assets/images/v2-6d9971cf95295743a7bc0fcf438640d0_720w-be73552a90e1fd980f0078bc84c7994f.webp" width="720" height="503" class="img_ev3q"></p><p><strong>工厂方法模式</strong>(Factory Method)</p><p><img loading="lazy" src="/assets/images/v2-f593af4bb7517e40fa79a10abce8bb67_720w-64df0303a5655ab0e97e5b0488ae60c7.webp" width="720" height="446" class="img_ev3q"></p><p>左右两棵树的子类型一一对应，如果工厂方法里使用<code>Type</code>表征右侧的子类型，那么左侧的子类型只要 1 个即可</p><p><strong>访问者模式</strong>(Visitor)</p><p><img loading="lazy" src="/assets/images/v2-d42eb5a4a40c71a3c573994042dec27a_720w-7206f3b687a25bd5f0f8d2cea4be95ae.webp" width="720" height="444" class="img_ev3q"></p><p>左右两侧的两棵树的子类型，基本上是一一对应，但左侧树中的不同子类型可能对应右侧树中的同一个子类型<code>visitor</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2><ul><li>Creational patterns<ul><li>Factory method: 创建对象而不指定确切的类</li></ul></li><li>Structural patterns<ul><li>Adapter: 通过将自己的接口包装在已有的类来使不兼容接口的类一起工作</li><li>Decorator: 动态<strong>添加</strong>/<strong>重写</strong>类中的方法</li></ul></li><li>Behavioral patterns<ul><li>Strategy: 允许在运行时选择算法</li><li>Template method: 将算法的骨架定义为抽象类，让子类来实现</li><li>Iterator: 顺序访问对象的元素而不暴露其底层表示</li><li>Visitor: 将某些方法分离出来，委派给独立的对象</li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/kcxain/Kcx_Learning/tree/master/docs/system/Software-Construction/Note8-详解七大设计模式.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/system/Software-Construction/note7"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Note7-面向可维护性的软件构造技术</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/system/Software-Construction/convex-problem"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">二维凸包问题详解</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#创建型模式creational-patterns" class="table-of-contents__link toc-highlight">创建型模式(Creational patterns)</a><ul><li><a href="#工厂方法模式factory-method-pattern" class="table-of-contents__link toc-highlight">工厂方法模式(Factory Method pattern)</a></li></ul></li><li><a href="#结构型模式structural-patterns" class="table-of-contents__link toc-highlight">结构型模式(Structural patterns)</a><ul><li><a href="#适配器模式adapter" class="table-of-contents__link toc-highlight">适配器模式(Adapter)</a></li><li><a href="#装饰器模式decorator" class="table-of-contents__link toc-highlight">装饰器模式(Decorator)</a></li></ul></li><li><a href="#行为类模式behavioral-patterns" class="table-of-contents__link toc-highlight">行为类模式(Behavioral patterns)</a><ul><li><a href="#策略模式strategy" class="table-of-contents__link toc-highlight">策略模式(Strategy)</a></li><li><a href="#模板模式template-method" class="table-of-contents__link toc-highlight">模板模式(Template Method)</a></li><li><a href="#迭代器模式iterator" class="table-of-contents__link toc-highlight">迭代器模式(Iterator)</a></li><li><a href="#访问者模式visitor" class="table-of-contents__link toc-highlight">访问者模式(Visitor)</a></li></ul></li><li><a href="#设计模式的共性" class="table-of-contents__link toc-highlight">设计模式的共性</a><ul><li><a href="#共性样式继承" class="table-of-contents__link toc-highlight">共性样式：继承</a></li><li><a href="#共性样式继承委托" class="table-of-contents__link toc-highlight">共性样式：继承+委托</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">联系我</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/kcxain" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.zhihu.com/people/deconx" target="_blank" rel="noopener noreferrer" class="footer__link-item">知乎<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/kecxain" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Kcx_Learning, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.77a452bf.js"></script>
<script src="/assets/js/main.b7d7721f.js"></script>
</body>
</html>